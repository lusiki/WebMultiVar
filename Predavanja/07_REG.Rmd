---
title: "MULTIVARIJATNE STATISTIČKE METODE"
author: "dr.sc. Luka Šikić"
date: "Fakultet hrvatskih studija | [Github MV](https://lusiki.github.io/WebMultiVar/)"
# subtitle: "<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>"
subtitle: "Predavanje 7: Multivarijatna regresijska analiza"
output:
  xaringan::moon_reader:
    css: [default, metropolis, metropolis-fonts] 
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
  fig.align="center", #fig.width=6, fig.height=4.5, 
  # out.width="748px", #out.length="520.75px",
  dpi=300, #fig.path='Figs/',
  cache=T, echo=T, warning=F, message=F
  )
knitr::opts_hooks$set(fig.callout = function(options) {
  if (options$fig.callout) {
    options$echo <- FALSE
    options$out.height <- "99%"
    options$fig.width <- 16
    options$fig.height <- 8
  }
  options
})
```

```{css, echo = F, eval = T}
@media print {
  .has-continuation {
    display: block !important;
  }
}
remark-slide-content {
  font-size: 22px;
  padding: 20px 80px 20px 80px;
}
.remark-code, .remark-inline-code {
  background: #f0f0f0;
}
.remark-code {
  font-size: 16px;
}
.mid. remark-code { /*Change made here*/
  font-size: 60% !important;
}
.tiny .remark-code { /*Change made here*/
  font-size: 40% !important;
}

/* custom.css */
.left-code {
  color: #777;
  width: 38%;
  height: 92%;
  float: left;
}
.right-plot {
  width: 60%;
  float: right;
  padding-left: 1%;
}
.plot-callout {
  height: 225px;
  width: 450px;
  bottom: 5%;
  right: 5%;
  position: absolute;
  padding: 0px;
  z-index: 100;
}
.plot-callout img {
  width: 100%;
  border: 4px solid #23373B;
}
```

```{r paketi, warning=F, echo=F, message=F, eval=TRUE}

library(tidyverse)  # data manipulation and visualization
library(gridExtra)  # plot arrangement
library(ggplot2)
library(tidyverse)
library(dplyr)
```

# Pregled predavanja

<br>
<br>
<br>


1. [Praktični primjer](#exemplar)

2. [Univarijatna regresijska analiza](#uni)

2. [Predikcija i elementi modela](#pred)

3. [Kvaliteta procjene](#qual)

3. [Višestruka regresija](#multi)


---

class: inverse, center, middle
name: exemplar

# PRAKTIČNI PRIMJER

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

(Motivacija)

---


# Podatci

```{r}
# Koristimo "marketing" podatkovni skup iz "datarium" paketa
library(datarium) # učitaj paket
data("marketing") # učitaj podatke
# Podatci se odnose na prodajni efekt ulaganja u promidžbu na youtube, facebook i novinske oglase
head(marketing,10) # pogledaj podatke 
```

---

# Model
<br>
<br>
- cilj je procijeniti utjecaj oglašavanja na youtube, fb i novinskih oglasa na prodaju
<br>
- procjenjujemo model `sales = b0 + b1*youtube + b2*facebook + b3*newspaper`
<br>
```{r}
# Procijeni model u R
model <- lm(sales ~ youtube + facebook + newspaper, data = marketing)
```
---

# Model

```{r}
# Rezultati modela
summary(model)
```

---

# Interpretacija

```{r}
model$coefficent
```

---

# Poboljšanje modela

```{r}
# izbaci nesignifikantnu varijablu
model  <- lm(sales ~ youtube + facebook, data = marketing)
summary(model)
```

---

# Kvaliteta modela

```{r}
confint(model)
```

##### R-sq
```{r}

```

##### RSE

```{r}
sigma(model)/mean(marketing$sales)
```

---

# Alternativna specifikacija
<br>
<br>
```{r}
# Svi prediktori u jednom funkcijskom pozivu
model <- lm(sales ~., data = marketing)
# Selekcija prediktora; bez varijable newspaper
model <- lm(sales ~. -newspaper, data = marketing)
# Također moguće i korištenje sintakse
model1 <- update(model,  ~. -newspaper)
```

---

class: inverse, center, middle
name: uni

# UVIVARIJATNA REGRESIJA

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

(Osnovni model)


---

# Podatci

```{r}
library(dplyr)
# Učitaj podatke
SMID <- read.csv2("../Podatci/SLR.csv", header = TRUE) %>% # podatci na GHubu
  rename(n_claims = X, total_payment_sek = Y) # preimenuj varijable
str(SMID) # struktura
head(SMID, 5) # pogledaj podatke
```

---

# Deskriptivna statistika

.pull-left[
```{r}
library(dplyr)
SMID %>%
summarize_all(mean)
```
]

.pull-right[
```{r}
SMID %>%
summarize(correlation = cor(n_claims, total_payment_sek))
```
]


---

# Što je regresija?

- statistički model koji objašnjava odnos između zavisne i nezavisne varijable
- uz danu vrijednost nezavisne varijable, kolika je vrijednsot zavisne?

```{r,echo=FALSE}
tribble(~n_claims, ~total_payment_sel,
  "108","392.5",
  "19","46.2",
  "13","15.7",
  "124","422.2",
  "40","119.4",
  "200","???")
```

---

# Osnovna terminologija

###### ŽARGON
<br>
<br>
- *response* varijabla ili zavisna varijable je ona koju želimo predvidjeti
- *eksplanatorna* varijabla ili nazavisna je ona koja objašnjava promjenu u zavisnoj

###### DEFINICIJE
<br>
<br>
- Linearna regresija: zavisna varijabla je numenrička
- Logistička regresija: zavisna varijabla je logička (0,1)
- Univarijatna regresija: samo jedna nezavisna varijabla
- MUltivarijatna regresija: više zavisnih varijabli

<br>
<br>
---

# Vizualizacija
<br>
<br>
.left-code[
```{r plot-label, eval=FALSE}
library(ggplot2)
ggplot(SMID,
aes(n_claims, total_payment_sek)) +
geom_point()
```
]

.right-plot[
```{r plot-label-out, ref.label="plot-label", echo=FALSE, fig.height=4}

```
]


---

# Dodaj regresijski pravac
<br>
<br>
.left-code[
```{r plot-label2, eval=FALSE}
library(ggplot2)
ggplot(SMID,
aes(n_claims, total_payment_sek)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)  
```
]

.right-plot[
```{r plot-label2-out, ref.label="plot-label2", echo=FALSE, fig.height=4}

```
]













