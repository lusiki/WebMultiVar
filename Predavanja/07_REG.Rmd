---
title: "MULTIVARIJATNE STATISTIČKE METODE"
author: "dr.sc. Luka Šikić"
date: "Fakultet hrvatskih studija | [Github MV](https://lusiki.github.io/WebMultiVar/)"
# subtitle: "<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>"
subtitle: "Predavanje 7: Multivarijatna regresijska analiza"
output:
  xaringan::moon_reader:
    css: [default, metropolis, metropolis-fonts] 
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
  fig.align="center", #fig.width=6, fig.height=4.5, 
  # out.width="748px", #out.length="520.75px",
  dpi=300, #fig.path='Figs/',
  cache=F#, echo=F, warning=F, message=F
  )
```

```{css, echo = F, eval = T}
@media print {
  .has-continuation {
    display: block !important;
  }
}
remark-slide-content {
  font-size: 22px;
  padding: 20px 80px 20px 80px;
}
.remark-code, .remark-inline-code {
  background: #f0f0f0;
}
.remark-code {
  font-size: 16px;
}
.mid. remark-code { /*Change made here*/
  font-size: 60% !important;
}
.tiny .remark-code { /*Change made here*/
  font-size: 40% !important;
}
```

```{r paketi, warning=F, echo=F, message=F, eval=TRUE}

library(tidyverse)  # data manipulation and visualization
library(gridExtra)  # plot arrangement
library(ggplot2)
library(tidyverse)
library(dplyr)
```

# Pregled predavanja

<br>
<br>
<br>


1. [Praktični primjer](#exemplar)

2. [Univarijatna regresijska analiza](#uni)

2. [Predikcija i elementi modela](#pred)

3. [Kvaliteta procjene](#qual)

3. [Višestruka regresija](#multi)


---

class: inverse, center, middle
name: exemplar

# PRAKTIČNI PRIMJER

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

(Motivacija)

---


# Podatci

```{r}
# Koristimo "marketing" podatkovni skup iz "datarium" paketa
library(datarium) # učitaj paket
data("marketing") # učitaj podatke
# Podatci se odnose na prodajni efekt ulaganja u promidžbu na youtube, facebook i novinske oglase
head(marketing,10) # pogledaj podatke 
```

---

# Model
<br>
<br>
- cilj je procijeniti utjecaj oglašavanja na youtube, fb i novinskih oglasa na prodaju
<br>
- procjenjujemo model `sales = b0 + b1*youtube + b2*facebook + b3*newspaper`
<br>
```{r}
# Procijeni model u R
model <- lm(sales ~ youtube + facebook + newspaper, data = marketing)
```
---

# Model

```{r}
# Rezultati modela
summary(model)
```

---

# Interpretacija

```{r}
summary(model)$coefficent
```

---

# Poboljšanje modela

```{r}
# izbaci nesignifikantnu varijablu
model  <- lm(sales ~ youtube + facebook, data = marketing)
summary(model)
```

---

# Kvaliteta modela

```{r}
confint(model)
```

##### R-sq
```{r}

```

##### RSE

```{r}
sigma(model)/mean(marketing$sales)
```

---

# Alternativna specifikacija

```{r}
# Svi prediktori u jednom funkcijskom pozivu
model <- lm(sales ~., data = marketing)
# Selekcija prediktora; bez varijable newspaper
model <- lm(sales ~. -newspaper, data = marketing)
# Također moguće i korištenje sintakse
model1 <- update(model,  ~. -newspaper)
```

---

class: inverse, center, middle
name: uni

# UVIVARIJATNA REGRESIJA

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

(Motivacija)


---



