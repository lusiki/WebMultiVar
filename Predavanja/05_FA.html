<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MULTIVARIJATNE STATISTIČKE METODE</title>
    <meta charset="utf-8" />
    <meta name="author" content="Luka Šikić, PhD" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# MULTIVARIJATNE STATISTIČKE METODE
## Predavanje 5: Faktorska analiza
### Luka Šikić, PhD
### Fakultet hrvatskih studija | <a href="https://lusiki.github.io/WebMultiVar/">Github MV</a>

---





&lt;style type="text/css"&gt;
@media print {
  .has-continuation {
    display: block !important;
  }
}
remark-slide-content {
  font-size: 22px;
  padding: 20px 80px 20px 80px;
}
.remark-code, .remark-inline-code {
  background: #f0f0f0;
}
.remark-code {
  font-size: 16px;
}
.mid. remark-code { /*Change made here*/
  font-size: 60% !important;
}
.tiny .remark-code { /*Change made here*/
  font-size: 40% !important;
}
&lt;/style&gt;



# Pregled predavanja

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;


1. [Jednodimenzionalna faktorska analiza (FA)](#uni)

2. [Multidimenzionalna FA](#multi)

3. [Konfirmatorna FA](#conf)


---
class: inverse, center, middle
name: uni

# FAKTORSKA ANALIZA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Općenito)

---

# Karakteristike FA
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
- Charles Spearman (1904) zaslužan za uvođenje FA
&lt;br&gt;
- FA ima mnogo sličnosti sa PCA
&lt;br&gt;
- Cilj FA je reducirati veliki broj (koreliranih) varijabli na mali broj indeksa (faktora)
&lt;br&gt;
- FA je statistički model (za razliku od PCA koja je statistička metoda)
&lt;br&gt;
- Ekstenzija (C)FA je modeliranje strukturnih jednadžbi (SEM) 
&lt;br&gt;
&lt;br&gt;
.footnote[[*]Izvstan uvodni [turorial](https://stats.idre.ucla.edu/spss/seminars/introduction-to-factor-analysis/a-practical-introduction-to-factor-analysis/).]
---

# Vrste FA
&lt;br&gt;
&lt;br&gt;

.pull-left[
##### EKSPLORATIVNA

- koristi se u fazi razvoja modela
- pregled faktorske strukture
- opća slika o varijablama
]

.pull-right[
##### KONFIRMATORNA

- procijeni kostnrukt
- koristi se nakon razvoja mjere

]

.footnote[[*]Ogledni primjer za motivaciju FA na [poveznici](https://pdf.sciencedirectassets.com/280203/1-s2.0-S1877050915X00123/1-s2.0-S1877050915013605/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGgaCXVzLWVhc3QtMSJGMEQCIEKL%2BgWTeDULrBDdHjLVVYTpTw0x1b3IcmAwY2fj49agAiB%2F6alKu3d8Cd6HSjQBNDTNSPxADKPdUigLTWG0YLbrpSq9Awih%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDA1OTAwMzU0Njg2NSIMR5PnGB3hxYeBGMh5KpEDhNllxnviP6RXrFwFD6GCbdR4qA8%2BcDAcuyonvbAcLcYcjusNF1bVoxijJsUrTO7IHkq1%2F6gfTMW%2Fuis0iw0h5BZsVMg8d2xIt4XVDq2uCE1378Si6BN1zAc7%2BTpI1OX7MlwN0RFYXYcItSs0uGptpELpdqCSC5MbpvOHq2dSk32Rr96UfUtgWP5%2BK00neqh8raUZTOICa9qgQ1e2xraj1yH5PwwZjprfpODiFNnxbUX3FyzYw446DDa0o0hp5Nq0ftEFsQXXLt8PREU4DbGF6URs7yhNp3EUW8FsbNaFBW83FUkq5g8EB22KbnfoaMjL%2FGdX75QKy2Wi2IAKOJ0Gbg1dR8hEMfVvG25lzN3YWBHTZP1CDH43ucW01bUD47CoguLZJ3OlB1YX%2F8VirEyyMqS%2FZDTGRX6PVJw3tt5otbaMDOSxofNnEjIbLMz7POE4XcOPUiTzMorx7xZUqn3n8s6D7jtS%2F9rRExcwJ%2B8KGkG8npqhI70AGEthDjpR6Ja4%2FwnPp2LT07McMcYzGcfORrQwyJHhggY67AGoh98fTEoT0vbi3g%2FgJjuNSkhome8unAE873Wvjb0czEg8VUzqUmq2lgHQFbsrRqyly1HXxTi1garhIhwOXMs7OH%2F13G4dbweUnzHfvHGhkmCGPNEPCO%2BuiAzsv25woyDCYEabk1PIWUbmF5Zy2blhh4tvZ2STlB1w6tM6GVYbXVAHPO3m4CrLYfSDdw86vPFkzWAs2lav7u911%2FCJBWFX%2B18kZ0yN7ChfqR2t2M46ZtQWAbG3NLWlrnWMcpq4hwkth0VI84FgisBGO8jRU5L3wdJcNYFUj7K8DczHTrE6XzDJhIBVldLhUpXjAA%3D%3D&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Date=20210322T080825Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=300&amp;X-Amz-Credential=ASIAQ3PHCVTYWHRILQQO%2F20210322%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Signature=6d94252743a7ed60e313fbcccbf494512775492c51e14248e59850866d82cdde&amp;hash=ff6722f6278a608c06c40e587140d6976c1cd76177433d4700cc253bb613a370&amp;host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&amp;pii=S1877050915013605&amp;tid=spdf-2c946717-28f9-49fa-b844-b8b4f083fea2&amp;sid=b1057b8a1956c546f55a7420b46302cb07cbgxrqb&amp;type=client).]

---
class: inverse, center, middle

# OGLEDNI PRIMJER

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Pretpostavke za analizu)

---

# Paket i podatci
&lt;br&gt;

- koristimo `psych` paket
- za detalje o paketu pogledajte [Personality project](http://personality-project.org/r/psych/)


```r
# učitaj paket
library(psych)
```

- koristimo `gcbs` podatkovni skup (Generic Conspiracist Beliefs Survey)
- provjerite da li i vas prisluškuju na [Open psychometrics](https://openpsychometrics.org/tests/GCBS/) :-)


```r
gcbs &lt;- readRDS("../Podatci/GCBS_data.rds")
```


---

# Pregledaj podatke


```r
str(gcbs)
```

```
## 'data.frame':	2495 obs. of  15 variables:
##  $ Q1 : int  5 5 2 5 5 1 4 5 1 1 ...
##  $ Q2 : int  5 5 4 4 4 1 3 4 1 2 ...
##  $ Q3 : int  3 5 1 1 1 1 3 3 1 1 ...
##  $ Q4 : int  5 5 2 2 4 1 3 3 1 1 ...
##  $ Q5 : int  5 5 2 4 4 1 4 4 1 1 ...
##  $ Q6 : int  5 3 2 5 5 1 3 5 1 5 ...
##  $ Q7 : int  5 5 4 4 4 1 3 5 1 1 ...
##  $ Q8 : int  3 5 2 1 3 1 4 5 1 1 ...
##  $ Q9 : int  4 1 2 4 1 1 2 5 1 1 ...
##  $ Q10: int  5 4 4 5 5 1 3 5 1 4 ...
##  $ Q11: int  5 4 2 5 5 1 3 5 1 1 ...
##  $ Q12: int  5 5 4 5 5 1 2 5 1 1 ...
##  $ Q13: int  3 4 0 1 3 1 2 3 1 1 ...
##  $ Q14: int  5 4 2 4 5 1 3 4 1 1 ...
##  $ Q15: int  5 5 4 5 5 1 4 5 1 5 ...
```

---

# Konstrukti
&lt;br&gt;
&lt;br&gt;
- Zavjera vlade (GM)
&lt;br&gt;
- Prikrivanje vanzemaljaca (ET)
&lt;br&gt;
- Zle i zavjereničke globalne organizacije (MG)
&lt;br&gt;
- Osobna dobrobit (PW)
&lt;br&gt;
- Kontrola informacija (CI)

Za detalje o varijablama pogledajte [Measuring belief in conspiracy theories](https://www.frontiersin.org/articles/10.3389/fpsyg.2013.00279/full).

---

# Varijable i konstrukti

&lt;img src="../Foto/konstrukti_FA.png" width="400px" style="display: block; margin: auto;" /&gt;

---

# Jednodimenzionalni konstrukt

&lt;img src="../Foto/unidim_FA.png" width="400px" style="display: block; margin: auto;" /&gt;

---

# Jednodimenzionalni konstrukt

.tiny[
.pull-left[

```r
EFA_model &lt;- fa(gcbs) # Default je 1 faktor
EFA_model$loadings
```

```
## 
## Loadings:
##     MR1  
## Q1  0.703
## Q2  0.719
## Q3  0.638
## Q4  0.770
## Q5  0.672
## Q6  0.746
## Q7  0.734
## Q8  0.654
## Q9  0.695
## Q10 0.565
## Q11 0.719
## Q12 0.786
## Q13 0.679
## Q14 0.743
## Q15 0.574
## 
##                  MR1
## SS loadings    7.267
## Proportion Var 0.484
```
]
]

.pull-right[

```r
fa.diagram(EFA_model)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;

]





---
class: inverse, center, middle
name: multi

# MULTIDIMENZIONALNA (E)FA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(U praksi uvijek ima više od jedne dimenzije)

---

# Procedura provedbe EFA
&lt;br&gt;
&lt;br&gt;
- Provjeri faktorabilnost
&lt;br&gt;
&lt;br&gt;
- Izvuci faktore
&lt;br&gt;
&lt;br&gt;
- Izaberi odgovarajući broj faktora
&lt;br&gt;
&lt;br&gt;
- Rotiraj faktore
&lt;br&gt;
&lt;br&gt;
- Interpretiraj rezultate


---

# Podatci

- koristimo podatke Synthetic Aperture Personality Assessment (SAPA)
- 2.800 osoba
- 25 pitanja
.tiny[

```r
data(bfi)
str(bfi)
```

```
## 'data.frame':	2800 obs. of  28 variables:
##  $ A1       : int  2 2 5 4 2 6 2 4 4 2 ...
##  $ A2       : int  4 4 4 4 3 6 5 3 3 5 ...
##  $ A3       : int  3 5 5 6 3 5 5 1 6 6 ...
##  $ A4       : int  4 2 4 5 4 6 3 5 3 6 ...
##  $ A5       : int  4 5 4 5 5 5 5 1 3 5 ...
##  $ C1       : int  2 5 4 4 4 6 5 3 6 6 ...
##  $ C2       : int  3 4 5 4 4 6 4 2 6 5 ...
##  $ C3       : int  3 4 4 3 5 6 4 4 3 6 ...
##  $ C4       : int  4 3 2 5 3 1 2 2 4 2 ...
##  $ C5       : int  4 4 5 5 2 3 3 4 5 1 ...
##  $ E1       : int  3 1 2 5 2 2 4 3 5 2 ...
##  $ E2       : int  3 1 4 3 2 1 3 6 3 2 ...
##  $ E3       : int  3 6 4 4 5 6 4 4 NA 4 ...
##  $ E4       : int  4 4 4 4 4 5 5 2 4 5 ...
##  $ E5       : int  4 3 5 4 5 6 5 1 3 5 ...
##  $ N1       : int  3 3 4 2 2 3 1 6 5 5 ...
##  $ N2       : int  4 3 5 5 3 5 2 3 5 5 ...
##  $ N3       : int  2 3 4 2 4 2 2 2 2 5 ...
##  $ N4       : int  2 5 2 4 4 2 1 6 3 2 ...
##  $ N5       : int  3 5 3 1 3 3 1 4 3 4 ...
##  $ O1       : int  3 4 4 3 3 4 5 3 6 5 ...
##  $ O2       : int  6 2 2 3 3 3 2 2 6 1 ...
##  $ O3       : int  3 4 5 4 4 5 5 4 6 5 ...
##  $ O4       : int  4 3 5 3 3 6 6 5 6 5 ...
##  $ O5       : int  3 3 2 5 3 1 1 3 1 2 ...
##  $ gender   : int  1 2 2 2 1 2 1 1 1 2 ...
##  $ education: int  NA NA NA NA NA 3 NA 2 1 NA ...
##  $ age      : int  16 18 17 17 17 21 18 19 19 17 ...
```
]

---

# Podatci


```r
head(bfi)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 61617  2  4  3  4  4  2  3  3  4  4  3  3  3  4  4  3  4  2  2  3  3  6  3  4
## 61618  2  4  5  2  5  5  4  4  3  4  1  1  6  4  3  3  3  3  5  5  4  2  4  3
## 61620  5  4  5  4  4  4  5  4  2  5  2  4  4  4  5  4  5  4  2  3  4  2  5  5
## 61621  4  4  6  5  5  4  4  3  5  5  5  3  4  4  4  2  5  2  4  1  3  3  4  3
## 61622  2  3  3  4  5  4  4  5  3  2  2  2  5  4  5  2  3  4  4  3  3  3  4  3
## 61623  6  6  5  6  5  6  6  6  1  3  2  1  6  5  6  3  5  2  2  3  4  3  5  6
##       O5 gender education age
## 61617  3      1        NA  16
## 61618  3      2        NA  18
## 61620  2      2        NA  17
## 61621  5      2        NA  17
## 61622  3      1        NA  17
## 61623  1      2         3  21
```

---

# Podatci
&lt;br&gt;
&lt;br&gt;

```r
names(bfi)
```

```
##  [1] "A1"        "A2"        "A3"        "A4"        "A5"        "C1"       
##  [7] "C2"        "C3"        "C4"        "C5"        "E1"        "E2"       
## [13] "E3"        "E4"        "E5"        "N1"        "N2"        "N3"       
## [19] "N4"        "N5"        "O1"        "O2"        "O3"        "O4"       
## [25] "O5"        "gender"    "education" "age"
```

---

# Konstrukt


&lt;img src="../Foto/bfi_FA.png" width="350px" style="display: block; margin: auto;" /&gt;

---

# Konstrukt

- konstrukt se ne može direktno mjeriti
- primjeri: samoodređenost, sposobnost razmišljanja, politička pripadnost, ekstrovertiranost 
&lt;br&gt;
&lt;br&gt;
&lt;img src="../Foto/konstrukt_FA.png" width="450px" style="display: block; margin: auto;" /&gt;

---

# Faktorabilnost
&lt;br&gt;
&lt;br&gt;
.pull-left[
- `Barlett sphericity` test (BS)


```r
bfi_hetcor &lt;- polycor::hetcor(bfi[,1:25]) # korelacije
bfi_c &lt;- bfi_hetcor$correlations # kor- matrica
bfi_faktorablinost &lt;- cortest.bartlett(bfi_c) # Barlett test
bfi_faktorablinost
```

```
## $chisq
## [1] 671.9842
## 
## $p.value
## [1] 1.497658e-30
## 
## $df
## [1] 300
```

]


.pull-right[
- `Keiser-Meyer-Olkin` test (MKO)

```r
KMO(bfi_c) # KMO test
```

```
## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = bfi_c)
## Overall MSA =  0.85
## MSA for each item = 
##   A1   A2   A3   A4   A5   C1   C2   C3   C4   C5   E1   E2   E3   E4   E5   N1 
## 0.75 0.84 0.87 0.88 0.90 0.84 0.80 0.85 0.83 0.86 0.84 0.88 0.90 0.88 0.89 0.78 
##   N2   N3   N4   N5   O1   O2   O3   O4   O5 
## 0.78 0.86 0.89 0.86 0.86 0.78 0.84 0.77 0.76
```


]


---

# Ekstrakcija faktora

- `minres` : minimum residual [default] (slightly modi,ed methods: ols , wls , gls )
- `mle` : Maximum Likelihood Estimation (MLE)
- `paf` : Principal Axes Factor (PAF) extraction
- `minchi` : minimum sample size weighted chi square
- `minrank` : minimum rank
- `alpha` : alpha factoring

---

# `minres` metoda 


```r
# EFA sa 3 faktora
f_bfi_minres &lt;- fa(bfi_c,nfactors = 3,rotate = "none")
# Sortiraj komunalnosti
f_bfi_minres_common &lt;- sort(f_bfi_minres$communality,decreasing = TRUE)
# Pregled
data.frame(f_bfi_minres_common)
```

```
##    f_bfi_minres_common
## N1          0.56715487
## N3          0.56113538
## N2          0.55677884
## E4          0.48921654
## C4          0.44941776
## N4          0.44918583
## A5          0.43893666
## E2          0.42084854
## A3          0.41199010
## E3          0.40486692
## C2          0.39247081
## C1          0.35896592
## E5          0.35085660
## C5          0.34733958
## A2          0.30361184
## N5          0.28385319
## E1          0.26500012
## C3          0.23630259
## O3          0.23069582
## A4          0.19125132
## O1          0.16005307
## O2          0.09668726
## O4          0.08193146
## O5          0.08056401
## A1          0.06161429
```
---

# `minres` metoda 


```r
# Sortiraj jedinstvenosti
f_bfi_minres_unique &lt;- sort(f_bfi_minres$uniqueness,decreasing = TRUE)
# Pregled
head(data.frame(f_bfi_minres_unique),10)
```

```
##    f_bfi_minres_unique
## A1           0.9383857
## O5           0.9194360
## O4           0.9180685
## O2           0.9033127
## O1           0.8399469
## A4           0.8087487
## O3           0.7693042
## C3           0.7636974
## E1           0.7349999
## N5           0.7161468
```

---

# `MLE` metoda 



```r
# MLE ekstrakcija
f_bfi_mle &lt;- fa(bfi_c, nfactors = 3, fm ="ml")
```

```
## Loading required namespace: GPArotation
```

```r
# Sortiraj komunalnost
f_bfi_mle_common &lt;- sort(f_bfi_mle$communality,decreasing = TRUE)
# Pregled
head(data.frame(f_bfi_mle_common),10)
```

```
##    f_bfi_mle_common
## N1        0.6602592
## N2        0.6427504
## N3        0.5241467
## E4        0.4912137
## C4        0.4756779
## A5        0.4348396
## E2        0.4194426
## C2        0.4188591
## E3        0.4055702
## N4        0.3923124
```

---

# Koliko faktora zadržati
&lt;br&gt;
- Kaiser-Guttman test
- Scree test
- Parallel analiza
&lt;br&gt;

```r
fa.parallel(bfi_c, n.obs = 200,fa = "fa", fm = "minres") # minres metoda 
```

```
## Warning in fa.stats(r = r, f = f, phi = phi, n.obs = n.obs, np.obs = np.obs, :
## The estimated weights for the factor scores are probably incorrect. Try a
## different factor score estimation method.
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;

```
## Parallel analysis suggests that the number of factors =  5  and the number of components =  NA
```

---

# Koliko faktora zadržati


```r
fa.parallel(bfi_c, n.obs = 200,fa = "fa", fm = "mle") # MLE metoda
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-20-1.png" style="display: block; margin: auto;" /&gt;

```
## Parallel analysis suggests that the number of factors =  5  and the number of components =  NA
```

---

# Rotacija faktora

- Rotacija se radi zbog lakše interpretacije

.pull_left[
##### Ortogonalna
- Quartimax
- Equiumax
- Varimax
]

.pull_right[
##### Zaobljena
- Direct Oblimin
- Promax
]

---

# Rotacija faktora

&lt;img src="../Foto/roto_FA.png" width="550px" style="display: block; margin: auto;" /&gt;

---

# Varimax rotacija


```r
f_bfi_varimax &lt;- fa(bfi_c,fm = "minres",nfactors = 5,rotate = "varimax")
```

&lt;img src="../Foto/varimax_FA.png" width="350px" style="display: block; margin: auto;" /&gt;

---

# Interpretacija


```r
fa.diagram(f_bfi_varimax)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-24-1.png" style="display: block; margin: auto;" /&gt;
---


# Interpretacija

.tiny[

```r
print(f_bfi_varimax$loadings, cut=0)
```

```
## 
## Loadings:
##    MR2    MR1    MR3    MR5    MR4   
## A1  0.111  0.040  0.023 -0.428 -0.078
## A2  0.030  0.214  0.139  0.627  0.062
## A3  0.009  0.318  0.109  0.651  0.056
## A4 -0.066  0.205  0.231  0.436 -0.113
## A5 -0.122  0.393  0.088  0.537  0.067
## C1  0.010  0.070  0.546  0.039  0.210
## C2  0.090  0.033  0.649  0.103  0.115
## C3 -0.031  0.024  0.557  0.112 -0.005
## C4  0.240 -0.065 -0.634 -0.037 -0.108
## C5  0.290 -0.176 -0.562 -0.048  0.037
## E1  0.043 -0.575  0.033 -0.105 -0.059
## E2  0.245 -0.679 -0.102 -0.113 -0.042
## E3  0.024  0.537  0.083  0.258  0.281
## E4 -0.116  0.647  0.102  0.306 -0.073
## E5  0.036  0.504  0.313  0.090  0.214
## N1  0.787  0.079 -0.046 -0.216 -0.085
## N2  0.754  0.027 -0.031 -0.194 -0.010
## N3  0.732 -0.061 -0.067 -0.028 -0.004
## N4  0.591 -0.345 -0.179  0.006  0.075
## N5  0.538 -0.161 -0.037  0.101 -0.150
## O1 -0.002  0.213  0.115  0.062  0.505
## O2  0.176  0.005 -0.100  0.082 -0.469
## O3  0.027  0.311  0.077  0.127  0.596
## O4  0.221 -0.191 -0.022  0.155  0.369
## O5  0.085 -0.005 -0.063 -0.010 -0.534
## 
##                  MR2   MR1   MR3   MR5   MR4
## SS loadings    2.710 2.473 2.041 1.844 1.522
## Proportion Var 0.108 0.099 0.082 0.074 0.061
## Cumulative Var 0.108 0.207 0.289 0.363 0.424
```
]


---

# Podijeli podatke
&lt;br&gt;
&lt;br&gt;


```r
N &lt;- nrow(bfi)
indices &lt;- seq(1, N)
indices_EFA &lt;- sample(indices, floor((.5*N)))
indices_CFA &lt;- indices[!(indices %in% indices_EFA)]
bfi_EFA &lt;- bfi[indices_EFA, ]
bfi_CFA &lt;- bfi[indices_CFA, ]
```

---

# Podijeli podatke


```r
head(bfi_EFA, 2)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 65700  6  6  6  6  5  4  3  3  1  2  5  2  3  6  5  2  4  2  4  3  3  4  4  5
## 65941  2  6  6  6  5  5  4  5  3  1  2  2  5  5  5  4  4  4  4  3  6  4  4  4
##       O5 gender education age
## 65700  3      2         3  31
## 65941  3      2         1  22
```

```r
head(bfi_CFA, 2)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 61617  2  4  3  4  4  2  3  3  4  4  3  3  3  4  4  3  4  2  2  3  3  6  3  4
## 61618  2  4  5  2  5  5  4  4  3  4  1  1  6  4  3  3  3  3  5  5  4  2  4  3
##       O5 gender education age
## 61617  3      1        NA  16
## 61618  3      2        NA  18
```

---

# ...bez teorije


&lt;img src="../Foto/noTheory_FA.png" width="550px" style="display: block; margin: auto;" /&gt;

---

# Korelacijska matrica

.tiny[

```r
bfi_EFA_cor &lt;- cor(bfi_EFA, use = "pairwise.complete.obs")
head(bfi_EFA_cor,4) 
```

```
##            A1         A2         A3         A4         A5         C1         C2
## A1  1.0000000 -0.3401171 -0.2580723 -0.1578581 -0.2045737 0.03054712 0.02616165
## A2 -0.3401171  1.0000000  0.4581372  0.3146575  0.4046006 0.08277232 0.10722065
## A3 -0.2580723  0.4581372  1.0000000  0.3489849  0.5008366 0.08867070 0.14166756
## A4 -0.1578581  0.3146575  0.3489849  1.0000000  0.3302894 0.08366594 0.21061474
##            C3         C4          C5         E1          E2          E3
## A1 0.02010481  0.1299280  0.04483549  0.1318190  0.08767825 -0.03297868
## A2 0.16575848 -0.1591875 -0.14574932 -0.2203507 -0.24436264  0.23658672
## A3 0.12371144 -0.1356514 -0.19871089 -0.2184534 -0.28089974  0.37219618
## A4 0.11212806 -0.1772391 -0.21102393 -0.1241075 -0.17432652  0.18428163
##             E4          E5          N1          N2          N3          N4
## A1 -0.08098905 -0.04213274  0.11343244  0.10051842  0.06187191  0.03456489
## A2  0.28363300  0.30776988 -0.07850079 -0.05252877 -0.00559850 -0.09352939
## A3  0.35805206  0.24281800 -0.09834920 -0.10091538 -0.03939572 -0.12325760
## A4  0.31108231  0.17114839 -0.11570295 -0.15807970 -0.09095426 -0.18256719
##              N5         O1         O2          O3          O4          O5
## A1 -0.010076480 0.05307876 0.03176690 -0.05256315 -0.09570764  0.08283617
## A2  0.045882351 0.08510070 0.02748310  0.14973708  0.06491926 -0.05713972
## A3 -0.023315269 0.11991850 0.03401647  0.24139782  0.05557222 -0.04789263
## A4  0.002370816 0.02520930 0.04947636  0.06807923 -0.04618720  0.02052702
##         gender   education         age
## A1 -0.15303318 -0.16325222 -0.14644830
## A2  0.19286227  0.04349919  0.09386227
## A3  0.13205535  0.01349639  0.04378046
## A4  0.09872604 -0.01202468  0.14600701
```
]

---

# Svojsvene vrijednosti



```r
scree(bfi_EFA_cor, factors = FALSE)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-30-1.png" style="display: block; margin: auto;" /&gt;


---

# Eksplorativna vs. konfirmatorna FA


&lt;img src="../Foto/konf_FA.png" width="350px" style="display: block; margin: auto;" /&gt;


&lt;img src="../Foto/eksp_FA.png" width="350px" style="display: block; margin: auto;" /&gt;


---

# Provedi FA

.tiny[

```r
EFA_model &lt;- fa(bfi_EFA, nfactors = 6)
EFA_model
```

```
## Factor Analysis using method =  minres
## Call: fa(r = bfi_EFA, nfactors = 6)
## Standardized loadings (pattern matrix) based upon correlation matrix
##             MR2   MR4   MR1   MR5   MR3   MR6    h2   u2 com
## A1         0.06  0.07 -0.06 -0.58  0.01  0.34 0.388 0.61 1.7
## A2         0.04  0.10 -0.10  0.61  0.01 -0.03 0.439 0.56 1.1
## A3        -0.05  0.05 -0.11  0.56  0.08  0.16 0.469 0.53 1.3
## A4        -0.09  0.19 -0.06  0.39 -0.11  0.13 0.272 0.73 2.1
## A5        -0.16  0.04 -0.19  0.50  0.06  0.21 0.498 0.50 2.0
## C1         0.03  0.51  0.08 -0.02  0.20  0.04 0.317 0.68 1.4
## C2         0.08  0.63  0.15  0.02  0.12  0.22 0.472 0.53 1.5
## C3         0.03  0.57  0.04  0.02 -0.06  0.07 0.305 0.69 1.1
## C4         0.06 -0.67  0.05 -0.06  0.02  0.25 0.548 0.45 1.3
## C5         0.13 -0.60  0.15  0.00  0.09  0.04 0.463 0.54 1.3
## E1        -0.13  0.09  0.63 -0.12 -0.07  0.09 0.428 0.57 1.3
## E2         0.06 -0.04  0.66 -0.07 -0.08  0.00 0.530 0.47 1.1
## E3         0.01  0.00 -0.35  0.15  0.36  0.31 0.518 0.48 3.3
## E4        -0.06  0.03 -0.52  0.22 -0.01  0.27 0.525 0.48 2.0
## E5         0.14  0.25 -0.45  0.06  0.23  0.02 0.434 0.57 2.4
## N1         0.81 -0.03 -0.10 -0.09 -0.03  0.01 0.649 0.35 1.1
## N2         0.84  0.03 -0.08 -0.07 -0.01 -0.08 0.676 0.32 1.1
## N3         0.72 -0.03  0.12  0.08  0.04  0.07 0.591 0.41 1.1
## N4         0.45 -0.15  0.42  0.10  0.11  0.06 0.517 0.48 2.5
## N5         0.48  0.02  0.21  0.20 -0.13  0.12 0.366 0.63 2.1
## O1        -0.05  0.05 -0.05 -0.08  0.58  0.13 0.379 0.62 1.2
## O2         0.09 -0.09  0.03  0.14 -0.43  0.29 0.303 0.70 2.3
## O3        -0.01  0.00 -0.08  0.07  0.68  0.02 0.511 0.49 1.1
## O4         0.09 -0.04  0.33  0.18  0.36 -0.01 0.238 0.76 2.6
## O5         0.01 -0.07 -0.03  0.01 -0.51  0.30 0.339 0.66 1.7
## gender     0.24  0.09 -0.10  0.29 -0.19 -0.10 0.165 0.84 3.6
## education -0.04 -0.03  0.05  0.16  0.12 -0.24 0.087 0.91 2.6
## age       -0.08  0.07  0.06  0.22  0.03 -0.22 0.098 0.90 2.6
## 
##                        MR2  MR4  MR1  MR5  MR3  MR6
## SS loadings           2.59 2.11 2.19 1.97 1.80 0.87
## Proportion Var        0.09 0.08 0.08 0.07 0.06 0.03
## Cumulative Var        0.09 0.17 0.25 0.32 0.38 0.41
## Proportion Explained  0.22 0.18 0.19 0.17 0.16 0.08
## Cumulative Proportion 0.22 0.41 0.60 0.77 0.92 1.00
## 
##  With factor correlations of 
##       MR2   MR4   MR1   MR5   MR3   MR6
## MR2  1.00 -0.21  0.23 -0.06  0.00  0.09
## MR4 -0.21  1.00 -0.23  0.17  0.21  0.03
## MR1  0.23 -0.23  1.00 -0.28 -0.19 -0.11
## MR5 -0.06  0.17 -0.28  1.00  0.15  0.15
## MR3  0.00  0.21 -0.19  0.15  1.00  0.08
## MR6  0.09  0.03 -0.11  0.15  0.08  1.00
## 
## Mean item complexity =  1.8
## Test of the hypothesis that 6 factors are sufficient.
## 
## The degrees of freedom for the null model are  378  and the objective function was  7.91 with Chi Square of  10987.83
## The degrees of freedom for the model are 225  and the objective function was  0.68 
## 
## The root mean square of the residuals (RMSR) is  0.03 
## The df corrected root mean square of the residuals is  0.03 
## 
## The harmonic number of observations is  1376 with the empirical chi square  716.57  with prob &lt;  1.2e-52 
## The total number of observations was  1400  with Likelihood Chi Square =  944.61  with prob &lt;  8e-89 
## 
## Tucker Lewis Index of factoring reliability =  0.886
## RMSEA index =  0.048  and the 90 % confidence intervals are  0.045 0.051
## BIC =  -685.34
## Fit based upon off diagonal values = 0.98
## Measures of factor score adequacy             
##                                                    MR2  MR4  MR1  MR5  MR3  MR6
## Correlation of (regression) scores with factors   0.93 0.89 0.89 0.87 0.87 0.77
## Multiple R square of scores with factors          0.87 0.79 0.79 0.76 0.75 0.59
## Minimum correlation of possible factor scores     0.73 0.57 0.58 0.52 0.50 0.19
```
]

---

# Faktorska opterećenja

.tiny[

```r
EFA_model$loadings
```

```
## 
## Loadings:
##           MR2    MR4    MR1    MR5    MR3    MR6   
## A1                             -0.585         0.340
## A2                              0.610              
## A3                      -0.111  0.561         0.161
## A4                0.186         0.387 -0.112  0.127
## A5        -0.163        -0.192  0.495         0.213
## C1                0.509                0.195       
## C2                0.634  0.147         0.120  0.221
## C3                0.566                            
## C4               -0.666                       0.246
## C5         0.131 -0.601  0.147                     
## E1        -0.134         0.632 -0.123              
## E2                       0.659                     
## E3                      -0.350  0.152  0.359  0.308
## E4                      -0.515  0.220         0.270
## E5         0.138  0.251 -0.445         0.227       
## N1         0.808        -0.101                     
## N2         0.841                                   
## N3         0.719         0.123                     
## N4         0.447 -0.152  0.423         0.109       
## N5         0.477         0.215  0.199 -0.132  0.123
## O1                                     0.576  0.130
## O2                              0.142 -0.429  0.294
## O3                                     0.677       
## O4                       0.333  0.183  0.365       
## O5                                    -0.507  0.300
## gender     0.244                0.289 -0.189 -0.102
## education                       0.160  0.124 -0.236
## age                             0.216        -0.216
## 
##                  MR2   MR4   MR1   MR5   MR3   MR6
## SS loadings    2.509 1.971 1.934 1.811 1.727 0.835
## Proportion Var 0.090 0.070 0.069 0.065 0.062 0.030
## Cumulative Var 0.090 0.160 0.229 0.294 0.355 0.385
```
]


---

# Faktorski koeficijenti
&lt;br&gt;
&lt;br&gt;


```r
head(EFA_model$scores)
```

```
##               MR2        MR4        MR1        MR5         MR3        MR6
## 65700 -0.28224220  0.2734598 -0.3610542  0.3082020 -0.94779957  0.3201301
## 65941  0.52875225  0.3640569 -0.7396458  0.6968652 -0.10862430  0.8971304
## 64340 -0.04431507  1.0230220 -0.9370336  0.4721843 -0.01641601  0.6537493
## 62508          NA         NA         NA         NA          NA         NA
## 62467 -0.77691548 -0.9435103 -0.2128417 -0.6054915 -0.80058312 -0.7055557
## 64727  1.89544224 -0.7718135  0.6007803 -0.4073056 -0.57581483  0.9801393
```

---

# Procjena kvalitete modela (fit)
&lt;br&gt;
&lt;br&gt;
##### Apsolutne mjere

- Chi-square test: nesignifikanstnost
- Tucker-Lewis Index (TLI) : &gt; 0.90
- Root Mean Square Error of Approximation (RMSEA): &lt; 0.05

##### Relativne mjere

- Bayesian Information Criterion (BIC)

---

# Procjena kvalitete modela (relativna)


```r
EFA_model &lt;- fa(bfi_EFA, nfactors = 6)
EFA_model
```


```r
bfi_theory &lt;- fa(bfi_EFA, nfactors = 5)
bfi_eigen &lt;- fa(bfi_EFA, nfactors = 6)

bfi_theory$BIC
```

```
## [1] -333.7418
```

```r
bfi_eigen$BIC
```

```
## [1] -685.341
```


---
class: inverse, center, middle
name: conf

# KONFIRMATORNA FA (CFA)

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Teorija u pozadini...)

---

# Razlozi za korištenje
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
- Eksplicitno specificiran odnos među varijablama
&lt;br&gt;
&lt;br&gt;
- Testiranje teorije koja je unaprijed poznata
&lt;br&gt;
&lt;br&gt;
- Pristup koji se koristi kod razvoja nove mjere


---


# Skica I (*jedan konstrukt*)
&lt;br&gt;
&lt;br&gt;


&lt;img src="assets/9247750.png" width="614" style="display: block; margin: auto;" /&gt;

---

# Skica II (*više konstrukata*)
&lt;br&gt;
&lt;br&gt;
&lt;img src="assets/2561893.png" width="507" style="display: block; margin: auto;" /&gt;


---

# Podatci



```r
hz &lt;- lavaan::HolzingerSwineford1939
hz %&gt;% dplyr::glimpse()
```

```
## Rows: 301
## Columns: 15
## $ id     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, ~
## $ sex    &lt;int&gt; 1, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, ~
## $ ageyr  &lt;int&gt; 13, 13, 13, 13, 12, 14, 12, 12, 13, 12, 12, 12, 12, 12, 12, 12,~
## $ agemo  &lt;int&gt; 1, 7, 1, 2, 2, 1, 1, 2, 0, 5, 2, 11, 7, 8, 6, 1, 11, 5, 8, 3, 1~
## $ school &lt;fct&gt; Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, ~
## $ grade  &lt;int&gt; 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, ~
## $ x1     &lt;dbl&gt; 3.333333, 5.333333, 4.500000, 5.333333, 4.833333, 5.333333, 2.8~
## $ x2     &lt;dbl&gt; 7.75, 5.25, 5.25, 7.75, 4.75, 5.00, 6.00, 6.25, 5.75, 5.25, 5.7~
## $ x3     &lt;dbl&gt; 0.375, 2.125, 1.875, 3.000, 0.875, 2.250, 1.000, 1.875, 1.500, ~
## $ x4     &lt;dbl&gt; 2.333333, 1.666667, 1.000000, 2.666667, 2.666667, 1.000000, 3.3~
## $ x5     &lt;dbl&gt; 5.75, 3.00, 1.75, 4.50, 4.00, 3.00, 6.00, 4.25, 5.75, 5.00, 3.5~
## $ x6     &lt;dbl&gt; 1.2857143, 1.2857143, 0.4285714, 2.4285714, 2.5714286, 0.857142~
## $ x7     &lt;dbl&gt; 3.391304, 3.782609, 3.260870, 3.000000, 3.695652, 4.347826, 4.6~
## $ x8     &lt;dbl&gt; 5.75, 6.25, 3.90, 5.30, 6.30, 6.65, 6.20, 5.15, 4.65, 4.55, 5.7~
## $ x9     &lt;dbl&gt; 6.361111, 7.916667, 4.416667, 4.861111, 5.916667, 7.500000, 4.8~
```
.footnote[[*] Vidi detalje o podatcima na [poveznici](https://rdrr.io/cran/lavaan/man/HolzingerSwineford1939.html).]

---

# Definiraj model

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

##### Sintaksa za definiranje CFA modela:


```r
hz.model &lt;- '
visual =~ x1 + x2 + x3
writing =~ x4 + x5 + x6
maths =~ x7 + x8 + x9
'
```



.footnote[ [*]Za detalje o lavaan projektu pogledajte [stranicu](https://lavaan.ugent.be/tutorial/syntax1.html).]

---

# Provedi model

.tiny[

```r
hz.fit &lt;- lavaan::cfa(hz.model, data=hz)
lavaan::summary(hz.fit, fit.measures=TRUE)
```

```
## lavaan 0.6-8 ended normally after 35 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        21
##                                                       
##   Number of observations                           301
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                85.306
##   Degrees of freedom                                24
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                               918.852
##   Degrees of freedom                                36
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.931
##   Tucker-Lewis Index (TLI)                       0.896
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -3737.745
##   Loglikelihood unrestricted model (H1)      -3695.092
##                                                       
##   Akaike (AIC)                                7517.490
##   Bayesian (BIC)                              7595.339
##   Sample-size adjusted Bayesian (BIC)         7528.739
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.092
##   90 Percent confidence interval - lower         0.071
##   90 Percent confidence interval - upper         0.114
##   P-value RMSEA &lt;= 0.05                          0.001
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.065
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   visual =~                                           
##     x1                1.000                           
##     x2                0.554    0.100    5.554    0.000
##     x3                0.729    0.109    6.685    0.000
##   writing =~                                          
##     x4                1.000                           
##     x5                1.113    0.065   17.014    0.000
##     x6                0.926    0.055   16.703    0.000
##   maths =~                                            
##     x7                1.000                           
##     x8                1.180    0.165    7.152    0.000
##     x9                1.082    0.151    7.155    0.000
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   visual ~~                                           
##     writing           0.408    0.074    5.552    0.000
##     maths             0.262    0.056    4.660    0.000
##   writing ~~                                          
##     maths             0.173    0.049    3.518    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .x1                0.549    0.114    4.833    0.000
##    .x2                1.134    0.102   11.146    0.000
##    .x3                0.844    0.091    9.317    0.000
##    .x4                0.371    0.048    7.779    0.000
##    .x5                0.446    0.058    7.642    0.000
##    .x6                0.356    0.043    8.277    0.000
##    .x7                0.799    0.081    9.823    0.000
##    .x8                0.488    0.074    6.573    0.000
##    .x9                0.566    0.071    8.003    0.000
##     visual            0.809    0.145    5.564    0.000
##     writing           0.979    0.112    8.737    0.000
##     maths             0.384    0.086    4.451    0.000
```
]


---

# Prikaži grafički



```r
semPlot::semPaths(hz.fit)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-44-1.png" style="display: block; margin: auto;" /&gt;


---

# Prikaži grafički 



```r
semPlot::semPaths(hz.fit, "std")
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-45-1.png" style="display: block; margin: auto;" /&gt;


---

# Kvaliteta procjene (Fit)

&lt;br&gt;
&lt;br&gt;

```r
lavaan::fitmeasures(hz.fit, c('cfi', 'rmsea', 'rmsea.ci.upper', 'bic'))
```

```
##            cfi          rmsea rmsea.ci.upper            bic 
##          0.931          0.092          0.114       7595.339
```



---

class: inverse, center, middle

# Hvala na pažnji

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Nastavak: Diskriminantna analiza)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
