<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MULTIVARIJATNE STATISTIČKE METODE</title>
    <meta charset="utf-8" />
    <meta name="author" content="Luka Šikić, PhD" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# MULTIVARIJATNE STATISTIČKE METODE
## Predavanje 5: Faktorska analiza
### Luka Šikić, PhD
### Fakultet hrvatskih studija | <a href="https://lusiki.github.io/WebMultiVar/">Github MV</a>

---





&lt;style type="text/css"&gt;
@media print {
  .has-continuation {
    display: block !important;
  }
}
remark-slide-content {
  font-size: 22px;
  padding: 20px 80px 20px 80px;
}
.remark-code, .remark-inline-code {
  background: #f0f0f0;
}
.remark-code {
  font-size: 16px;
}
.mid. remark-code { /*Change made here*/
  font-size: 60% !important;
}
.tiny .remark-code { /*Change made here*/
  font-size: 40% !important;
}
&lt;/style&gt;



# Pregled predavanja

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;


1. [Jednodimenzionalna faktorska analiza (FA)](#uni)

2. [Multidimenzionalna FA](#multi)

3. [Konfirmatorna FA](#conf)


---
class: inverse, center, middle
name: uni

# FAKTORSKA ANALIZA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Općenito)

---

# Karakteristike FA
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
- Charles Spearman (1904) zaslužan za uvođenje FA
&lt;br&gt;
- FA ima mnogo sličnosti sa PCA
&lt;br&gt;
- Cilj FA je reducirati veliki broj (koreliranih) varijabli na mali broj indeksa (faktora)
&lt;br&gt;
- FA je statistički model (za razliku od PCA koja je statistička metoda)
&lt;br&gt;
- Ekstenzija (C)FA je modeliranje strukturnih jednadžbi (SEM) 
&lt;br&gt;
&lt;br&gt;
.footnote[[*]Izvstan uvodni [turorial](https://stats.idre.ucla.edu/spss/seminars/introduction-to-factor-analysis/a-practical-introduction-to-factor-analysis/).]
---

# Vrste FA
&lt;br&gt;
&lt;br&gt;

.pull-left[
##### EKSPLORATIVNA

- koristi se u fazi razvoja modela
- pregled faktorske strukture
- opća slika o varijablama
]

.pull-right[
##### KONFIRMATORNA

- procijeni kostnrukt
- koristi se nakon razvoja mjere

]

.footnote[[*]Ogledni primjer za motivaciju FA na [poveznici](https://pdf.sciencedirectassets.com/280203/1-s2.0-S1877050915X00123/1-s2.0-S1877050915013605/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGgaCXVzLWVhc3QtMSJGMEQCIEKL%2BgWTeDULrBDdHjLVVYTpTw0x1b3IcmAwY2fj49agAiB%2F6alKu3d8Cd6HSjQBNDTNSPxADKPdUigLTWG0YLbrpSq9Awih%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDA1OTAwMzU0Njg2NSIMR5PnGB3hxYeBGMh5KpEDhNllxnviP6RXrFwFD6GCbdR4qA8%2BcDAcuyonvbAcLcYcjusNF1bVoxijJsUrTO7IHkq1%2F6gfTMW%2Fuis0iw0h5BZsVMg8d2xIt4XVDq2uCE1378Si6BN1zAc7%2BTpI1OX7MlwN0RFYXYcItSs0uGptpELpdqCSC5MbpvOHq2dSk32Rr96UfUtgWP5%2BK00neqh8raUZTOICa9qgQ1e2xraj1yH5PwwZjprfpODiFNnxbUX3FyzYw446DDa0o0hp5Nq0ftEFsQXXLt8PREU4DbGF6URs7yhNp3EUW8FsbNaFBW83FUkq5g8EB22KbnfoaMjL%2FGdX75QKy2Wi2IAKOJ0Gbg1dR8hEMfVvG25lzN3YWBHTZP1CDH43ucW01bUD47CoguLZJ3OlB1YX%2F8VirEyyMqS%2FZDTGRX6PVJw3tt5otbaMDOSxofNnEjIbLMz7POE4XcOPUiTzMorx7xZUqn3n8s6D7jtS%2F9rRExcwJ%2B8KGkG8npqhI70AGEthDjpR6Ja4%2FwnPp2LT07McMcYzGcfORrQwyJHhggY67AGoh98fTEoT0vbi3g%2FgJjuNSkhome8unAE873Wvjb0czEg8VUzqUmq2lgHQFbsrRqyly1HXxTi1garhIhwOXMs7OH%2F13G4dbweUnzHfvHGhkmCGPNEPCO%2BuiAzsv25woyDCYEabk1PIWUbmF5Zy2blhh4tvZ2STlB1w6tM6GVYbXVAHPO3m4CrLYfSDdw86vPFkzWAs2lav7u911%2FCJBWFX%2B18kZ0yN7ChfqR2t2M46ZtQWAbG3NLWlrnWMcpq4hwkth0VI84FgisBGO8jRU5L3wdJcNYFUj7K8DczHTrE6XzDJhIBVldLhUpXjAA%3D%3D&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Date=20210322T080825Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=300&amp;X-Amz-Credential=ASIAQ3PHCVTYWHRILQQO%2F20210322%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Signature=6d94252743a7ed60e313fbcccbf494512775492c51e14248e59850866d82cdde&amp;hash=ff6722f6278a608c06c40e587140d6976c1cd76177433d4700cc253bb613a370&amp;host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&amp;pii=S1877050915013605&amp;tid=spdf-2c946717-28f9-49fa-b844-b8b4f083fea2&amp;sid=b1057b8a1956c546f55a7420b46302cb07cbgxrqb&amp;type=client).]

---
class: inverse, center, middle

# PODATCI I PODRŠKA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Pretpostavke za analizu)

---

# Paket
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
- koristimo `psych` paket

- za detalje o paketu pogledajte [Personality project](http://personality-project.org/r/psych/)


```r
library(psych)
```

---

# Podatci

- koristimo `gcbs` podatkovni skup (Generic Conspiracist Beliefs Survey)
- provjerite da li i vas prisluškuju na [Open psychometrics](https://openpsychometrics.org/tests/GCBS/) :-)



```r
gcbs &lt;- readRDS("../Podatci/GCBS_data.rds")
str(gcbs)
```

```
## 'data.frame':	2495 obs. of  15 variables:
##  $ Q1 : int  5 5 2 5 5 1 4 5 1 1 ...
##  $ Q2 : int  5 5 4 4 4 1 3 4 1 2 ...
##  $ Q3 : int  3 5 1 1 1 1 3 3 1 1 ...
##  $ Q4 : int  5 5 2 2 4 1 3 3 1 1 ...
##  $ Q5 : int  5 5 2 4 4 1 4 4 1 1 ...
##  $ Q6 : int  5 3 2 5 5 1 3 5 1 5 ...
##  $ Q7 : int  5 5 4 4 4 1 3 5 1 1 ...
##  $ Q8 : int  3 5 2 1 3 1 4 5 1 1 ...
##  $ Q9 : int  4 1 2 4 1 1 2 5 1 1 ...
##  $ Q10: int  5 4 4 5 5 1 3 5 1 4 ...
##  $ Q11: int  5 4 2 5 5 1 3 5 1 1 ...
##  $ Q12: int  5 5 4 5 5 1 2 5 1 1 ...
##  $ Q13: int  3 4 0 1 3 1 2 3 1 1 ...
##  $ Q14: int  5 4 2 4 5 1 3 4 1 1 ...
##  $ Q15: int  5 5 4 5 5 1 4 5 1 5 ...
```


---

# Konstrukti
&lt;br&gt;
&lt;br&gt;
- Zavjera vlade (GM)
&lt;br&gt;
- Prikrivanje vanzemaljaca (ET)
&lt;br&gt;
- Zle i zavjereničke globalne organizacije (MG)
&lt;br&gt;
- Osobna dobrobit (PW)
&lt;br&gt;
- Kontrola informacija (CI)

Za detalje o varijablama pogledajte [Measuring belief in conspiracy theories](https://www.frontiersin.org/articles/10.3389/fpsyg.2013.00279/full).

---

# Varijable i konstrukti

&lt;img src="../Foto/konstrukti_FA.png" width="400px" style="display: block; margin: auto;" /&gt;

---

# Jednodimenzionalni konstrukt

&lt;img src="../Foto/unidim_FA.png" width="400px" style="display: block; margin: auto;" /&gt;

---

# Jednodimenzionalni konstrukt

.tiny[
.pull-left[

```r
EFA_model &lt;- fa(gcbs) # Default je 1 faktor
EFA_model$loadings
```

```
## 
## Loadings:
##     MR1  
## Q1  0.703
## Q2  0.719
## Q3  0.638
## Q4  0.770
## Q5  0.672
## Q6  0.746
## Q7  0.734
## Q8  0.654
## Q9  0.695
## Q10 0.565
## Q11 0.719
## Q12 0.786
## Q13 0.679
## Q14 0.743
## Q15 0.574
## 
##                  MR1
## SS loadings    7.267
## Proportion Var 0.484
```
]
]

.pull-right[

```r
fa.diagram(EFA_model)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

]





---
class: inverse, center, middle
name: uni

# MULTIDIMENZIONALNA FA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(U praksi uvijek ima više od jedne dimenzije)

---

# Podatci

- koristimo podatke Synthetic Aperture Personality Assessment (SAPA)
- 2.800 osoba
- 25 pitanja
.tiny[

```r
data(bfi)
str(bfi)
```

```
## 'data.frame':	2800 obs. of  28 variables:
##  $ A1       : int  2 2 5 4 2 6 2 4 4 2 ...
##  $ A2       : int  4 4 4 4 3 6 5 3 3 5 ...
##  $ A3       : int  3 5 5 6 3 5 5 1 6 6 ...
##  $ A4       : int  4 2 4 5 4 6 3 5 3 6 ...
##  $ A5       : int  4 5 4 5 5 5 5 1 3 5 ...
##  $ C1       : int  2 5 4 4 4 6 5 3 6 6 ...
##  $ C2       : int  3 4 5 4 4 6 4 2 6 5 ...
##  $ C3       : int  3 4 4 3 5 6 4 4 3 6 ...
##  $ C4       : int  4 3 2 5 3 1 2 2 4 2 ...
##  $ C5       : int  4 4 5 5 2 3 3 4 5 1 ...
##  $ E1       : int  3 1 2 5 2 2 4 3 5 2 ...
##  $ E2       : int  3 1 4 3 2 1 3 6 3 2 ...
##  $ E3       : int  3 6 4 4 5 6 4 4 NA 4 ...
##  $ E4       : int  4 4 4 4 4 5 5 2 4 5 ...
##  $ E5       : int  4 3 5 4 5 6 5 1 3 5 ...
##  $ N1       : int  3 3 4 2 2 3 1 6 5 5 ...
##  $ N2       : int  4 3 5 5 3 5 2 3 5 5 ...
##  $ N3       : int  2 3 4 2 4 2 2 2 2 5 ...
##  $ N4       : int  2 5 2 4 4 2 1 6 3 2 ...
##  $ N5       : int  3 5 3 1 3 3 1 4 3 4 ...
##  $ O1       : int  3 4 4 3 3 4 5 3 6 5 ...
##  $ O2       : int  6 2 2 3 3 3 2 2 6 1 ...
##  $ O3       : int  3 4 5 4 4 5 5 4 6 5 ...
##  $ O4       : int  4 3 5 3 3 6 6 5 6 5 ...
##  $ O5       : int  3 3 2 5 3 1 1 3 1 2 ...
##  $ gender   : int  1 2 2 2 1 2 1 1 1 2 ...
##  $ education: int  NA NA NA NA NA 3 NA 2 1 NA ...
##  $ age      : int  16 18 17 17 17 21 18 19 19 17 ...
```
]

---

# Podatci


```r
head(bfi)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 61617  2  4  3  4  4  2  3  3  4  4  3  3  3  4  4  3  4  2  2  3  3  6  3  4
## 61618  2  4  5  2  5  5  4  4  3  4  1  1  6  4  3  3  3  3  5  5  4  2  4  3
## 61620  5  4  5  4  4  4  5  4  2  5  2  4  4  4  5  4  5  4  2  3  4  2  5  5
## 61621  4  4  6  5  5  4  4  3  5  5  5  3  4  4  4  2  5  2  4  1  3  3  4  3
## 61622  2  3  3  4  5  4  4  5  3  2  2  2  5  4  5  2  3  4  4  3  3  3  4  3
## 61623  6  6  5  6  5  6  6  6  1  3  2  1  6  5  6  3  5  2  2  3  4  3  5  6
##       O5 gender education age
## 61617  3      1        NA  16
## 61618  3      2        NA  18
## 61620  2      2        NA  17
## 61621  5      2        NA  17
## 61622  3      1        NA  17
## 61623  1      2         3  21
```

---

# Podatci
&lt;br&gt;
&lt;br&gt;

```r
names(bfi)
```

```
##  [1] "A1"        "A2"        "A3"        "A4"        "A5"        "C1"       
##  [7] "C2"        "C3"        "C4"        "C5"        "E1"        "E2"       
## [13] "E3"        "E4"        "E5"        "N1"        "N2"        "N3"       
## [19] "N4"        "N5"        "O1"        "O2"        "O3"        "O4"       
## [25] "O5"        "gender"    "education" "age"
```

---

# Konstrukt


&lt;img src="../Foto/bfi_FA.png" width="550px" style="display: block; margin: auto;" /&gt;

---

# Konstrukt

- konstrukt se ne može direktno mjeriti
- primjeri: samoodređenost, sposobnost razmišljanja, politička pripadnost, ekstrovertiranost 
&lt;br&gt;
&lt;br&gt;
&lt;img src="../Foto/konstrukt_FA.png" width="450px" style="display: block; margin: auto;" /&gt;

---

# Podijeli podatke
&lt;br&gt;
&lt;br&gt;


```r
N &lt;- nrow(bfi)
indices &lt;- seq(1, N)
indices_EFA &lt;- sample(indices, floor((.5*N)))
indices_CFA &lt;- indices[!(indices %in% indices_EFA)]
bfi_EFA &lt;- bfi[indices_EFA, ]
bfi_CFA &lt;- bfi[indices_CFA, ]
```

---

# Podijeli podatke


```r
head(bfi_EFA, 2)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 66757  1  5  4  2  3  4  4  4  4  4  2  5  3  3  5  4  5  5  5  4  5  2  5  6
## 61838  2  5  5  5  2  6  6  4  1  5  3  2  2  2  5  4  5  5  5  4  6  2  5  6
##       O5 gender education age
## 66757  2      2         3  20
## 61838  1      1         5  47
```

```r
head(bfi_CFA, 2)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 61621  4  4  6  5  5  4  4  3  5  5  5  3  4  4  4  2  5  2  4  1  3  3  4  3
## 61622  2  3  3  4  5  4  4  5  3  2  2  2  5  4  5  2  3  4  4  3  3  3  4  3
##       O5 gender education age
## 61621  5      2        NA  17
## 61622  3      1        NA  17
```

---

# ...bez teorije


&lt;img src="../Foto/noTheory_FA.png" width="550px" style="display: block; margin: auto;" /&gt;

---

# Korelacijska matrica

.tiny[

```r
bfi_EFA_cor &lt;- cor(bfi_EFA, use = "pairwise.complete.obs")
head(bfi_EFA_cor,4) 
```

```
##            A1         A2         A3         A4         A5         C1
## A1  1.0000000 -0.2905517 -0.1797569 -0.1152389 -0.1486122 0.04299655
## A2 -0.2905517  1.0000000  0.4705169  0.3247143  0.3768249 0.07701518
## A3 -0.1797569  0.4705169  1.0000000  0.3742130  0.5171336 0.07543533
## A4 -0.1152389  0.3247143  0.3742130  1.0000000  0.3102930 0.07536331
##              C2          C3         C4          C5          E1         E2
## A1 -0.002448194 -0.02996083  0.1333576  0.03574983  0.07549226  0.0464424
## A2  0.139923829  0.21361859 -0.1669517 -0.14535604 -0.19457962 -0.2120082
## A3  0.153094440  0.18561061 -0.1248764 -0.18105411 -0.19044538 -0.2863968
## A4  0.244990812  0.15952719 -0.1902153 -0.27455743 -0.14724379 -0.2195858
##             E3           E4           E5          N1          N2          N3
## A1 0.009534576 -0.007856327 -0.001052211  0.16088861  0.14810259  0.13358425
## A2 0.222298697  0.271667622  0.295530922 -0.09170225 -0.04566059 -0.04753091
## A3 0.385362851  0.384065949  0.261881467 -0.06206536 -0.07196310 -0.03090398
## A4 0.203932623  0.310985718  0.196051005 -0.09297295 -0.13223958 -0.08540055
##             N4           N5         O1         O2          O3          O4
## A1  0.03678401  0.015232161 0.03119121 0.09623484 -0.07242904 -0.06865948
## A2 -0.09154514 -0.008635105 0.10927224 0.03531233  0.18427587  0.11467326
## A3 -0.14245659 -0.050154288 0.14851118 0.02710710  0.24336546  0.03559853
## A4 -0.18335198 -0.056882695 0.08188023 0.01908792  0.10804088 -0.04474375
##             O5     gender   education         age
## A1  0.14229142 -0.1562980 -0.12812156 -0.14235404
## A2 -0.09992000  0.1805420  0.00314298  0.07699440
## A3 -0.03112728  0.1290228 -0.01288093  0.06249514
## A4 -0.01052392  0.1270245 -0.03454948  0.13522774
```
]

---

# Svojsvene vrijednosti



```r
scree(bfi_EFA_cor, factors = FALSE)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /&gt;


---

# Eksplorativna vs. konfirmatorna FA


&lt;img src="../Foto/konf_FA.png" width="350px" style="display: block; margin: auto;" /&gt;


&lt;img src="../Foto/eksp_FA.png" width="350px" style="display: block; margin: auto;" /&gt;


---

# Provedi FA

.tiny[

```r
EFA_model &lt;- fa(bfi_EFA, nfactors = 6)
EFA_model
```

```
## Factor Analysis using method =  minres
## Call: fa(r = bfi_EFA, nfactors = 6)
## Standardized loadings (pattern matrix) based upon correlation matrix
##             MR2   MR3   MR5   MR1   MR4   MR6    h2   u2 com
## A1         0.11  0.06 -0.41 -0.07  0.06  0.46 0.348 0.65 2.2
## A2         0.02  0.09  0.62 -0.04  0.02 -0.16 0.445 0.56 1.2
## A3        -0.03  0.04  0.63 -0.10  0.08  0.06 0.506 0.49 1.1
## A4        -0.06  0.20  0.39 -0.11 -0.07  0.02 0.271 0.73 1.8
## A5        -0.19  0.02  0.55 -0.13  0.12  0.12 0.492 0.51 1.6
## C1         0.04  0.51 -0.03  0.12  0.16  0.08 0.299 0.70 1.4
## C2         0.09  0.68  0.06  0.15  0.07  0.12 0.481 0.52 1.2
## C3         0.01  0.52  0.15  0.11 -0.03  0.05 0.301 0.70 1.3
## C4         0.10 -0.65  0.04  0.11  0.04  0.22 0.547 0.45 1.4
## C5         0.19 -0.52  0.00  0.19  0.09 -0.02 0.429 0.57 1.6
## E1        -0.14  0.08 -0.12  0.60 -0.03  0.07 0.384 0.62 1.3
## E2         0.03  0.00 -0.10  0.68 -0.07 -0.01 0.550 0.45 1.1
## E3         0.00  0.01  0.26 -0.25  0.36  0.22 0.436 0.56 3.4
## E4        -0.04  0.03  0.32 -0.45  0.04  0.28 0.536 0.46 2.6
## E5         0.17  0.30  0.10 -0.37  0.21  0.02 0.391 0.61 3.2
## N1         0.81 -0.02 -0.07 -0.09 -0.02  0.03 0.642 0.36 1.0
## N2         0.84  0.03 -0.06 -0.08 -0.02 -0.05 0.673 0.33 1.0
## N3         0.68 -0.03  0.07  0.12  0.04  0.07 0.546 0.45 1.1
## N4         0.43 -0.13  0.07  0.42  0.10 -0.01 0.492 0.51 2.3
## N5         0.43 -0.01  0.21  0.29 -0.15  0.07 0.373 0.63 2.7
## O1        -0.04  0.05 -0.02  0.02  0.63  0.11 0.417 0.58 1.1
## O2         0.12 -0.09  0.21  0.06 -0.33  0.29 0.271 0.73 3.3
## O3         0.00  0.02  0.11 -0.07  0.62 -0.06 0.461 0.54 1.1
## O4         0.09 -0.03  0.17  0.35  0.36 -0.09 0.259 0.74 2.7
## O5         0.02 -0.01  0.06  0.01 -0.46  0.39 0.360 0.64 2.0
## gender     0.15  0.13  0.29 -0.03 -0.24 -0.17 0.165 0.83 3.7
## education  0.00  0.00  0.04  0.06  0.09 -0.23 0.066 0.93 1.5
## age       -0.06  0.07  0.10  0.01  0.06 -0.24 0.089 0.91 1.9
## 
##                        MR2  MR3  MR5  MR1  MR4  MR6
## SS loadings           2.52 2.03 2.08 2.04 1.67 0.90
## Proportion Var        0.09 0.07 0.07 0.07 0.06 0.03
## Cumulative Var        0.09 0.16 0.24 0.31 0.37 0.40
## Proportion Explained  0.22 0.18 0.19 0.18 0.15 0.08
## Cumulative Proportion 0.22 0.40 0.59 0.77 0.92 1.00
## 
##  With factor correlations of 
##       MR2   MR3   MR5   MR1   MR4   MR6
## MR2  1.00 -0.20 -0.05  0.26 -0.03  0.13
## MR3 -0.20  1.00  0.22 -0.20  0.18 -0.01
## MR5 -0.05  0.22  1.00 -0.27  0.21  0.10
## MR1  0.26 -0.20 -0.27  1.00 -0.17 -0.08
## MR4 -0.03  0.18  0.21 -0.17  1.00  0.00
## MR6  0.13 -0.01  0.10 -0.08  0.00  1.00
## 
## Mean item complexity =  1.9
## Test of the hypothesis that 6 factors are sufficient.
## 
## The degrees of freedom for the null model are  378  and the objective function was  7.54 with Chi Square of  10471.4
## The degrees of freedom for the model are 225  and the objective function was  0.65 
## 
## The root mean square of the residuals (RMSR) is  0.03 
## The df corrected root mean square of the residuals is  0.03 
## 
## The harmonic number of observations is  1374 with the empirical chi square  697.57  with prob &lt;  8.3e-50 
## The total number of observations was  1400  with Likelihood Chi Square =  904.5  with prob &lt;  3.3e-82 
## 
## Tucker Lewis Index of factoring reliability =  0.887
## RMSEA index =  0.046  and the 90 % confidence intervals are  0.043 0.05
## BIC =  -725.45
## Fit based upon off diagonal values = 0.98
## Measures of factor score adequacy             
##                                                    MR2  MR3  MR5  MR1  MR4  MR6
## Correlation of (regression) scores with factors   0.93 0.88 0.88 0.88 0.85 0.77
## Multiple R square of scores with factors          0.86 0.78 0.77 0.78 0.73 0.59
## Minimum correlation of possible factor scores     0.72 0.55 0.55 0.56 0.46 0.18
```
]

---

# Faktorska opterećenja

.tiny[

```r
EFA_model$loadings
```

```
## 
## Loadings:
##           MR2    MR3    MR5    MR1    MR4    MR6   
## A1         0.110        -0.407                0.459
## A2                       0.622               -0.164
## A3                       0.635                     
## A4                0.204  0.389 -0.106              
## A5        -0.193         0.548 -0.128  0.118  0.119
## C1                0.514         0.123  0.165       
## C2                0.676         0.151         0.120
## C3                0.520  0.150  0.106              
## C4         0.104 -0.652         0.115         0.219
## C5         0.193 -0.523         0.188              
## E1        -0.136        -0.124  0.605              
## E2                      -0.102  0.682              
## E3                       0.262 -0.249  0.359  0.219
## E4                       0.322 -0.451         0.282
## E5         0.166  0.296        -0.373  0.215       
## N1         0.806                                   
## N2         0.843                                   
## N3         0.681                0.122              
## N4         0.431 -0.128         0.420              
## N5         0.427         0.211  0.286 -0.154       
## O1                                     0.631  0.113
## O2         0.119         0.208        -0.335  0.294
## O3                       0.111         0.623       
## O4                       0.166  0.349  0.356       
## O5                                    -0.457  0.386
## gender     0.151  0.135  0.292        -0.242 -0.169
## education                                    -0.233
## age                      0.105               -0.239
## 
##                  MR2   MR3   MR5   MR1   MR4   MR6
## SS loadings    2.405 1.894 1.891 1.800 1.592 0.874
## Proportion Var 0.086 0.068 0.068 0.064 0.057 0.031
## Cumulative Var 0.086 0.154 0.221 0.285 0.342 0.373
```
]


---

# Faktorski koeficijenti
&lt;br&gt;
&lt;br&gt;


```r
head(EFA_model$scores)
```

```
##              MR2        MR3        MR5        MR1         MR4        MR6
## 66757  1.2304745 -0.7158970 -0.3916725  0.9081370  0.26576722 -0.7642684
## 61838  1.1534349  0.6971625 -0.5992622  0.7301752  0.89849966 -1.4380069
## 63900 -0.3589217  0.5503795 -1.3230677  0.3086152 -0.03987346 -0.3805212
## 66314 -1.0349343  1.0741188  0.5278979 -1.2345608 -0.17557513  0.6111159
## 64327  0.8122693 -0.7219180  0.8757444  0.1257834 -0.48187449  0.2470659
## 66680  0.1655470 -0.2088918 -0.3489737 -0.4549878 -1.14398212 -0.2998097
```

---

# Procjena kvalitete modela (fit)
&lt;br&gt;
&lt;br&gt;
##### Apsolutne mjere

- Chi-square test: nesignifikanstnost
- Tucker-Lewis Index (TLI) : &gt; 0.90
- Root Mean Square Error of Approximation (RMSEA): &lt; 0.05

##### Relativne mjere

- Bayesian Information Criterion (BIC)

---

# Procjena kvalitete modela (relativna)


```r
EFA_model &lt;- fa(bfi_EFA, nfactors = 6)
EFA_model
```


```r
bfi_theory &lt;- fa(bfi_EFA, nfactors = 5)
bfi_eigen &lt;- fa(bfi_EFA, nfactors = 6)

bfi_theory$BIC
```

```
## [1] -385.6062
```

```r
bfi_eigen$BIC
```

```
## [1] -725.4524
```


---
class: inverse, center, middle
name: conf

# KONFIRMATORNA FA (CFA)

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Teorija u pozadini...)

---

# Razlozi za korištenje
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
- Eksplicitno specificiran odnos među varijablama
&lt;br&gt;
&lt;br&gt;
- Testiranje teorije koja je unaprijed poznata
&lt;br&gt;
&lt;br&gt;
- Pristup koji se koristi kod razvoja nove mjere


---


# Skica I (*jedan konstrukt*)
&lt;br&gt;
&lt;br&gt;


&lt;img src="assets/8729071.png" width="614" style="display: block; margin: auto;" /&gt;

---

# Skica II (*više konstrukta*)
&lt;br&gt;
&lt;br&gt;
&lt;img src="assets/3508846.png" width="507" style="display: block; margin: auto;" /&gt;


---

# Podatci



```r
hz &lt;- lavaan::HolzingerSwineford1939
hz %&gt;% dplyr::glimpse()
```

```
## Rows: 301
## Columns: 15
## $ id     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, ~
## $ sex    &lt;int&gt; 1, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, ~
## $ ageyr  &lt;int&gt; 13, 13, 13, 13, 12, 14, 12, 12, 13, 12, 12, 12, 12, 12, 12, 12,~
## $ agemo  &lt;int&gt; 1, 7, 1, 2, 2, 1, 1, 2, 0, 5, 2, 11, 7, 8, 6, 1, 11, 5, 8, 3, 1~
## $ school &lt;fct&gt; Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, ~
## $ grade  &lt;int&gt; 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, ~
## $ x1     &lt;dbl&gt; 3.333333, 5.333333, 4.500000, 5.333333, 4.833333, 5.333333, 2.8~
## $ x2     &lt;dbl&gt; 7.75, 5.25, 5.25, 7.75, 4.75, 5.00, 6.00, 6.25, 5.75, 5.25, 5.7~
## $ x3     &lt;dbl&gt; 0.375, 2.125, 1.875, 3.000, 0.875, 2.250, 1.000, 1.875, 1.500, ~
## $ x4     &lt;dbl&gt; 2.333333, 1.666667, 1.000000, 2.666667, 2.666667, 1.000000, 3.3~
## $ x5     &lt;dbl&gt; 5.75, 3.00, 1.75, 4.50, 4.00, 3.00, 6.00, 4.25, 5.75, 5.00, 3.5~
## $ x6     &lt;dbl&gt; 1.2857143, 1.2857143, 0.4285714, 2.4285714, 2.5714286, 0.857142~
## $ x7     &lt;dbl&gt; 3.391304, 3.782609, 3.260870, 3.000000, 3.695652, 4.347826, 4.6~
## $ x8     &lt;dbl&gt; 5.75, 6.25, 3.90, 5.30, 6.30, 6.65, 6.20, 5.15, 4.65, 4.55, 5.7~
## $ x9     &lt;dbl&gt; 6.361111, 7.916667, 4.416667, 4.861111, 5.916667, 7.500000, 4.8~
```
.footnote[[*] Vidi detalje o podatcima na [poveznici](https://rdrr.io/cran/lavaan/man/HolzingerSwineford1939.html).]

---

# Definiraj model

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

##### Sintaksa za definiranje CFA modela:


```r
hz.model &lt;- '
visual =~ x1 + x2 + x3
writing =~ x4 + x5 + x6
maths =~ x7 + x8 + x9
'
```



.footnote[ [*]Za detalje o lavaan projektu pogledajte [stranicu](https://lavaan.ugent.be/tutorial/syntax1.html)].

---

# Provedi model

.tiny[

```r
hz.fit &lt;- lavaan::cfa(hz.model, data=hz)
lavaan::summary(hz.fit, fit.measures=TRUE)
```

```
## lavaan 0.6-8 ended normally after 35 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        21
##                                                       
##   Number of observations                           301
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                85.306
##   Degrees of freedom                                24
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                               918.852
##   Degrees of freedom                                36
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.931
##   Tucker-Lewis Index (TLI)                       0.896
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -3737.745
##   Loglikelihood unrestricted model (H1)      -3695.092
##                                                       
##   Akaike (AIC)                                7517.490
##   Bayesian (BIC)                              7595.339
##   Sample-size adjusted Bayesian (BIC)         7528.739
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.092
##   90 Percent confidence interval - lower         0.071
##   90 Percent confidence interval - upper         0.114
##   P-value RMSEA &lt;= 0.05                          0.001
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.065
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   visual =~                                           
##     x1                1.000                           
##     x2                0.554    0.100    5.554    0.000
##     x3                0.729    0.109    6.685    0.000
##   writing =~                                          
##     x4                1.000                           
##     x5                1.113    0.065   17.014    0.000
##     x6                0.926    0.055   16.703    0.000
##   maths =~                                            
##     x7                1.000                           
##     x8                1.180    0.165    7.152    0.000
##     x9                1.082    0.151    7.155    0.000
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   visual ~~                                           
##     writing           0.408    0.074    5.552    0.000
##     maths             0.262    0.056    4.660    0.000
##   writing ~~                                          
##     maths             0.173    0.049    3.518    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .x1                0.549    0.114    4.833    0.000
##    .x2                1.134    0.102   11.146    0.000
##    .x3                0.844    0.091    9.317    0.000
##    .x4                0.371    0.048    7.779    0.000
##    .x5                0.446    0.058    7.642    0.000
##    .x6                0.356    0.043    8.277    0.000
##    .x7                0.799    0.081    9.823    0.000
##    .x8                0.488    0.074    6.573    0.000
##    .x9                0.566    0.071    8.003    0.000
##     visual            0.809    0.145    5.564    0.000
##     writing           0.979    0.112    8.737    0.000
##     maths             0.384    0.086    4.451    0.000
```
]


---

# Prikaži grafički



```r
semPlot::semPaths(hz.fit)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-31-1.png" style="display: block; margin: auto;" /&gt;


---

# Prikaži grafički 



```r
semPlot::semPaths(hz.fit, "std")
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-32-1.png" style="display: block; margin: auto;" /&gt;


---

# Kvaliteta procjene (Fit)

&lt;br&gt;
&lt;br&gt;

```r
lavaan::fitmeasures(hz.fit, c('cfi', 'rmsea', 'rmsea.ci.upper', 'bic'))
```

```
##            cfi          rmsea rmsea.ci.upper            bic 
##          0.931          0.092          0.114       7595.339
```



---

class: inverse, center, middle

# Hvala na pažnji

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Nastavak: Diskriminantna analiza)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
