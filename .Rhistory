dist(dummieZadovoljstvo, method = "binary") # Udaljenost za kategorije
dummieZadovoljstvo
print(dummieZadovoljstvo)
print(zadovoljstvoPoslom)
dist(zadovoljstvoPoslom, method = "binary") # Udaljenost za kategorije
print(zadovoljstvo)
zadovoljstvo <- data.frame(
zadovoljstvo = c("Nisko","Nisko","Visoko","Nisko","Srednje"),
sreća = c("Ne","Ne","Da","Ne","Ne"))
kable(zadovoljstvo)
```{r}
dist(dummieZadovoljstvo, method = "binary") # Udaljenost za kategorije
knitr::include_graphics("../Foto/klastH1.png")
knitr::include_graphics("../Foto/klastH2.png")
knitr::include_graphics("../Foto/klastIZ1.png")
igraci <-  data.frame(X = c(-1,-2,8,7,-12,-15),
Y = c(1,-3,6,-8,8,0))
print(igraci)
dist_igraci <- dist(igraci, method = "euclidean")
klasteri <- cutree(hc_igraci, k = 2)
print(klasteri)
igraci <-  data.frame(X = c(-1,-2,8,7,-12,-15),
Y = c(1,-3,6,-8,8,0))
print(igraci)
dist_igraci <- dist(igraci, method = "euclidean") # Izračunaj udaljenost
hc_igraci <- hclust(dist_igraci, method = 'complete') # Provedi klastering
klasteri <- cutree(hc_igraci, k = 2)
print(klasteri)
igraciKlasteri<- mutate(igraci, cluster = klasteri)
library(tidyverse)  # data manipulation and visualization
library(gridExtra)  # plot arrangement
library(ggplot2)
library(tidyverse)
library(dplyr)
igraciKlasteri<- mutate(igraci, cluster = klasteri) # Prilagodba
print(igraciKlasteri)
ggplot(igraciKlasteri, aes(x = x, y = y, color = factor(klasteri)
ggplot(igraciKlasteri, aes(x = x, y = y, color = factor(klasteri)) +
ggplot(igraciKlasteri, aes(x = x, y = y, color = factor(klasteri))) +
geom_point()
ggplot(igraciKlasteri, aes(x = X, y = Y, color = factor(klasteri))) +
geom_point()
ggplot(igraciKlasteri, aes(x = X, y = Y, color = factor(klasteri))) +
geom_point() +
ggtitle("Igrači i klasteri u koordinatnom sustavu")
knitr::include_graphics("../Foto/klastDend1.png")
knitr::include_graphics("../Foto/klastDend8.png")
knitr::include_graphics("../Foto/klastDend9.png")
plot(hc_igraci)
knitr::include_graphics("../Foto/klastDend9.png")
knitr::include_graphics("../Foto/klastDend10.png")
install.packages("dendextend")
library(dendextend)
dend_igraci <- as.dendrogram(hc_igraci)
dend_boje <- color_branches(dend_igraci, h = 15)
plot(dend_boje)
klasteri <- cutree(hcIgraci, k = 2) # Odredi broj klastera
print(klasteri)
View(igraci)
knitr::include_graphics("../Foto/klastK9.png")
knitr::include_graphics("../Foto/klastK10.png")
print(lineup)
lineup <- (X=c(-1,-2,8,7,-12,-15,-13,15,21,12,-25,26),
print(lineup)
lineup <- (X=c(-1,-2,8,7,-12,-15,-13,15,21,12,-25,26),
lineup <- (X=c(-1,-2,8,7,-12,-15,-13,15,21,12,-25,26),
lineup <- (X=c(-1,-2,8,7,-12,-15,-13,15,21,12,-25,26),
lineup <- (X =c(-1,-2,8,7,-12,-15,-13,15,21,12,-25,26)
Y =c(1,-3,6,-8,8,0,-10,16,2,-15,1,0))
lineup <- (X =c(-1,-2,8,7,-12,-15,-13,15,21,12,-25,26), Y = c(1,-3,6,-8,8,0,-10,16,2,-15,1,0))
lineup <- data.frame(X =c(-1,-2,8,7,-12,-15,-13,15,21,12,-25,26),
Y = c(1,-3,6,-8,8,0,-10,16,2,-15,1,0))
print(lineup)
model <- kmeans(lineup, centers = 2)
print(model$cluster)
lineupKlasteri <- mutate(lineup, cluster = model$cluster)
print(lineupKlasteri)
head(print(lineupKlasteri),6)
knitr::include_graphics("../Foto/klastK10.png")
knitr::include_graphics("../Foto/klastK11.png")
knitr::include_graphics("../Foto/klastK14.png")
knitr::include_graphics("../Foto/klastK15.png")
model$tot.withinss # Kvaliteta modela
library(purrr)
tot_withinss <- map_dbl(1:10, function(k){
model <- kmeans(x = lineup, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
print(elbow_df)
head(print(elbow_df),5)
tot_withinss
ggplot(elbow_df, aes(x = k, y = tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 1:10)
knitr::include_graphics("../Foto/klastS1.png")
knitr::include_graphics("../Foto/klastS2.png")
knitr::include_graphics("../Foto/klastS3.png")
knitr::include_graphics("../Foto/klastS4.png")
knitr::include_graphics("../Foto/klastS5.png")
knitr::include_graphics("../Foto/klastS6.png")
knitr::include_graphics("../Foto/klastS7.png")
knitr::include_graphics("../Foto/klastS8.png")
library(cluster)
pam_k3 <- pam(lineup, k = 3)
pam_k3$silinfo$widths
sil_plot <- silhouette(pam_k3)
plot(sil_plot)
pam_k3$silinfo$avg.width
```{r}
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = lineup, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
print(sil_df)
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
fig.align="center", #fig.width=6, fig.height=4.5,
# out.width="748px", #out.length="520.75px",
dpi=300, #fig.path='Figs/',
cache=F#, echo=F, warning=F, message=F
)
# Napravi podatke
visinaTezina <- data.frame(Visina = c(6,6,8),
Tezina = c(200,202,200),
row.names = c(1,2,3))
visinaTezina
knitr::opts_chunk$set(echo = TRUE)
# Napravi podatke
lineup <- data.frame(X =c(-1,-2,8,7,-12,-15,-13,15,21,12,-25,26),
Y = c(1,-3,6,-8,8,0,-10,16,2,-15,1,0))
# Pregledaj podatke
head(print(lineup),6)
# Pregledaj podatke
print(lineup)
knitr::include_graphics("../Foto/klastK10.png")
knitr::include_graphics("../Foto/klastK11.png")
knitr::include_graphics("../Foto/klastS5.png")
devtools::install_github("kassmbara/datarium")
install.packages("datarium")
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
fig.align="center", #fig.width=6, fig.height=4.5,
# out.width="748px", #out.length="520.75px",
dpi=300, #fig.path='Figs/',
cache=F#, echo=F, warning=F, message=F
)
# Koristimo "marketing" podatkovni skup iz "datarium" paketa
library(datarium) # učitaj paket
data("marketing")
head(marketing,10)
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
fig.align="center", #fig.width=6, fig.height=4.5,
# out.width="748px", #out.length="520.75px",
dpi=300, #fig.path='Figs/',
cache=F#, echo=F, warning=F, message=F
)
SMID <- read.csv2("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/slr.csv")
SMID <- read.csv2("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/slr.xlsx")
SMID <- read.csv2("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/slr.xls")
library(readxl)
SMID <- read_excel("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/slr.xls")
SMID <- read_excel("../Podatci/slr.xls")
SMID <- read_excel("./Podatci/slr.xls")
SMID <- read.xls("./Podatci/slr.xls")
library(gdata)
SMID <- read.xls("./Podatci/slr.xls")
SMID <- read.xls("../Podatci/slr.xls")
library(gdata)
SMID <- read.xls("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/slr.xls")
SMID <- read.xls("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/slr.xls", sheet = 1)
SMID <- read.csv("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/slr.csv")
SMID <- read.csv("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/SLR.csv")
SMID <- read.csv("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/SLR.csv", header = TRUE)
SMID <- read.csv("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/SLR.csv", row.names = FALSE)
SMID <- read.csv2("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/SLR.csv", row.names = FALSE)
SMID <- read.csv2("D:/LUKA/Academic/HS/NASTAVA/20-21/WebMultiVar/Podatci/SLR.csv", header = TRUE)
SMID <- read.csv2("../Podatci/SLR.csv", header = TRUE)
str(SMID)
head(SMID) # pogledaj podatke
library(dplyr)
SMID %>%
summarize_all(mean)
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
fig.align="center", #fig.width=6, fig.height=4.5,
# out.width="748px", #out.length="520.75px",
dpi=300, #fig.path='Figs/',
cache=T, echo=T, warning=F, message=F
)
SMID %>%
summarize(
correlation = cor(n_claims, total_payment_sek)
)
# Učitaj podatke
SMID <- read.csv2("../Podatci/SLR.csv", header = TRUE) %>% # podatci na GHubu
rename(n_claims = X, total_payment_sek = Y)
str(SMID) # struktura
```{r}
# Učitaj podatke
SMID <- read.csv2("../Podatci/SLR.csv", header = TRUE) %>% # podatci na GHubu
rename(n_claims = X, total_payment_sek = Y) # preimenuj varijable
SMID %>%
summarize(correlation = cor(n_claims, total_payment_sek))
tribble(
~colA, ~colB,
"a",   1,
"b",   2,
"c",   3
)
tribble(
~n_claims, ~total_payment_sel,
"108",392.5,
"19",46.2,
"13",15.7,
"124",422.2,
"40",119.4,
"200",???
)
tribble(
~n_claims, ~total_payment_sel,
"108",392.5,
"19",46.2,
"13",15.7,
"124",422.2,
"40",119.4,
"200",???,
tribble(
~n_claims, ~total_payment_sel,
"108",392.5,
"19",46.2,
"13",15.7,
"124",422.2,
"40",119.4,
"200",???)
tribble(
~n_claims, ~total_payment_sel,
"108",392.5,
"19",46.2,
"13",15.7,
"124",422.2,
"40",119.4,
"200","???")
tribble(
~n_claims, ~total_payment_sel,
"108","392.5",
"19","46.2",
"13","15.7",
"124","422.2",
"40","119.4",
"200","???")
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
fig.align="center", #fig.width=6, fig.height=4.5,
# out.width="748px", #out.length="520.75px",
dpi=300, #fig.path='Figs/',
cache=T, echo=T, warning=F, message=F
)
knitr::opts_hooks$set(fig.callout = function(options) {
if (options$fig.callout) {
options$echo <- FALSE
options$out.height <- "99%"
options$fig.width <- 16
options$fig.height <- 8
}
options
})
model$coefficent
knitr::include_graphics("../Foto/reg5.png")
lm(total_payment_sek ~ n_claims, data = SMID)
fish <- read.table("http://www.amstat.org/publications/jse/datasets/fishcatch.dat.txt ")
View(fish)
colnames(fish) <- c("obs","species","weight","len1","len2","len3"
,"height.pct","width.pct","sex")
fish$species <- factor(fish$species, levels = c(1:7),
labels = c("Common Bream","Whitefish","Roach","Silver Bream"
,"Smelt","Pike","Perch"))
# Do not modify the following code:
fish.sub <- filter(fish, sex != "NA")
View(fish.sub)
# Do not modify the following code:
fish.sub <- filter(fish, sex != "NA") %>% select(species,mass_g)
View(fish.sub)
fish <- read.table("http://www.amstat.org/publications/jse/datasets/fishcatch.dat.txt ")
fish$species <- factor(fish$species, levels = c(1:7),
labels = c("Common Bream","Whitefish","Roach","Silver Bream"
,"Smelt","Pike","Perch"))
fish$species <- factor(fish$species, levels = c(1:7),
labels = c("Common Bream","Whitefish","Roach","Silver Bream"
,"Smelt","Pike","Perch"))
fish <- read.table("http://www.amstat.org/publications/jse/datasets/fishcatch.dat.txt ")
colnames(fish) <- c("obs","species","mass_g","len1","len2","len3"
,"height.pct","width.pct","sex")
fish$species <- factor(fish$species, levels = c(1:7),
labels = c("Common Bream","Whitefish","Roach","Silver Bream"
,"Smelt","Pike","Perch"))
# Do not modify the following code:
fish.sub <- filter(fish, sex != "NA") %>% select(species,mass_g)
View(fish.sub)
# Do not modify the following code:
fish.sub <- filter(fish, sex != "NA") %>% select(species,mass_g) %>% slice(-1)
View(fish.sub)
# Do not modify the following code:
fish <- filter(fish, sex != "NA") %>% select(species,mass_g) %>% slice(-1)
head(fish,10) # pogledaj podatke
head(sample_n(fish,10),10) # pogledaj podatke
unique(fish$species)
ggplot(fish, aes(mass_g)) +
geom_histogram(bins = 9) +
facet_wrap(vars(species))
library(tidyverse)  # data manipulation and visualization
library(gridExtra)  # plot arrangement
library(ggplot2)
library(tidyverse)
library(dplyr)
ggplot(fish, aes(mass_g)) +
geom_histogram(bins = 9) +
facet_wrap(vars(species))
fish %>%
group_by(species) %>%
summarize(mean_mass_g = mean(mass_g))
summarize(mean_mass_g = round(mean(mass_g),2)
fish %>%
fish %>%
group_by(species) %>%
summarize(mean_mass_g = round(mean(mass_g),2))
lm(mass_g ~ species, data = fish)
lm(mass_g ~ species + 0, data = fish)
View(fish)
fish <- read.table("http://www.amstat.org/publications/jse/datasets/fishcatch.dat.txt ")
colnames(fish) <- c("obs","species","mass_g","len1","len2","len3"
,"height.pct","width.pct","sex")
fish$species <- factor(fish$species, levels = c(1:7),
labels = c("Common Bream","Whitefish","Roach","Silver Bream"
,"Smelt","Pike","Perch"))
View(fish)
# Do not modify the following code:
fish <- filter(fish, sex != "NA") %>% select(species,mass_g,length_cm) %>% slice(-1)
fish <- read.table("http://www.amstat.org/publications/jse/datasets/fishcatch.dat.txt ")
colnames(fish) <- c("obs","species","mass_g","length_cm","len2","len3"
,"height.pct","width.pct","sex")
fish$species <- factor(fish$species, levels = c(1:7),
labels = c("Common Bream","Whitefish","Roach","Silver Bream"
,"Smelt","Pike","Perch"))
# Do not modify the following code:
fish <- filter(fish, sex != "NA") %>% select(species,mass_g,length_cm) %>% slice(-1)
View(fish)
bream <- fish %>%
filter(str_detect(species,"Bream"))
View(bream)
head(bream,10)
mdl_mass_vs_length <- lm(mass_g ~ length_cm, data = bream)
mdl_mass_vs_length
predict(tezina_vs_visina, nezavisne_vars)
nezavisne_vars <- tibble(length_cm = 20:40)
nezavisne_vars
predict(tezina_vs_visina, nezavisne_vars)
predict(tezina_vs_visina, nezavisne_vars)
tezina_vs_visina <- lm(mass_g ~ length_cm, data = bream)
tezina_vs_visina
predict(tezina_vs_visina, nezavisne_vars)
prediction_data <- explanatory_data %>%
mutate(mass_g = predict(tezina_vs_visina, nezavisne_vars))
prediction_data <- nezavisne_vars %>%
mutate(mass_g = predict(tezina_vs_visina, nezavisne_vars))
prediction_data
mali_bream <- tibble(length_cm = 10)
mali_bream %>%
mutate(mass_g = predict(tezina_vs_visina, mali_bream))
coefficients(tezina_vs_visina)
# jednako kao
explanatory_data <- bream %>% select(length_cm)
predict(tezina_vs_visina, explanatory_data)
residuals(tezina_vs_visina)
# ekvivalentno:
bream$mass_g - fitted(tezina_vs_visina)
library(broom)
tidy(tezina_vs_visina) # napravi tibble (dframe) procjene
augment(tezina_vs_visina)
View(fish)
# "Perch" vrsta ribe
```{r}
perch <- fish %>%
filter(species == "Perch")
head(perch,8)
ggplot(perch, aes(length_cm, mass_g)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
mdl_perch <- lm(mass_g ~ I(length_cm ^ 3), data = perch)
head(prediction_data,8)
library(gridExtra)
gg1 <- ggplot(perch, aes(length_cm ^ 3, mass_g)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
geom_point(data = prediction_data, color = "blue") +
ggtitle("Perch")
gg2 <- ggplot(perch, aes(length_cm, mass_g)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
geom_point(data = prediction_data, color = "blue")+
ggtitle("Bream")
library(gridExtra)
grid.arrange(gg1, gg2, ncol = 2)
mdl_bream %>%
glance()
mdl_bream <- lm(mass_g ~ length_cm, data = bream)
summary(mdl_bream) # Vidi R-squared
mdl_bream %>%
glance()
# Izvuci koeficijent determinacije
mdl_bream %>%
glance() %>%
pull(r.squared)
bream %>%
mutate(residuals_sq = residuals(mdl_bream) ^ 2)
# Izbacivanje opservacija sa visokom "polugom"
install.packages("ggfortify")
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
fig.align="center", #fig.width=6, fig.height=4.5,
# out.width="748px", #out.length="520.75px",
dpi=300, #fig.path='Figs/',
cache=T, echo=T, warning=F, message=F
)
knitr::opts_hooks$set(fig.callout = function(options) {
if (options$fig.callout) {
options$echo <- FALSE
options$out.height <- "99%"
options$fig.width <- 16
options$fig.height <- 8
}
options
})
# Koristimo "marketing" podatkovni skup iz "datarium" paketa
library(datarium) # učitaj paket
data("marketing") # učitaj podatke
# Podatci se odnose na prodajni efekt ulaganja u promidžbu na youtube, facebook i novinske oglase
head(marketing,10) # pogledaj podatke
# Procijeni model u R
model <- lm(sales ~ youtube + facebook + newspaper, data = marketing)
```
model <- lm(sales ~ youtube + facebook + newspaper, data = marketing)
# Rezultati modela
summary(model)
model$coefficents
str(model)
model$r.squared
summary(model)$r.squared
summary(model)$coefficients
summary(model)$coefficients
fish <- read.table("http://www.amstat.org/publications/jse/datasets/fishcatch.dat.txt ")
View(fish)
colnames(fish) <- c("obs","species","mass_g","length_cm","len2","len3"
,"height_cm","width.pct","sex")
fish$species <- factor(fish$species, levels = c(1:7),
labels = c("Common Bream","Whitefish","Roach","Silver Bream"
,"Smelt","Pike","Perch"))
# Do not modify the following code:
fish <- filter(fish, sex != "NA") %>% select(species,mass_g,length_cm) %>% slice(-1)
library(tidyverse)  # data manipulation and visualization
library(gridExtra)  # plot arrangement
library(ggplot2)
library(tidyverse)
library(dplyr)
# Do not modify the following code:
fish <- filter(fish, sex != "NA") %>% select(species,mass_g,length_cm) %>% slice(-1)
head(fish,10)
head(sample_n(fish,10),12)
fish <- read.table("http://www.amstat.org/publications/jse/datasets/fishcatch.dat.txt ")
colnames(fish) <- c("obs","species","mass_g","length_cm","len2","len3"
,"height_cm","width.pct","sex")
fish$species <- factor(fish$species, levels = c(1:7),
labels = c("Common Bream","Whitefish","Roach","Silver Bream"
,"Smelt","Pike","Perch"))
# Do not modify the following code:
fish <- filter(fish, sex != "NA") %>% select(species,mass_g,length_cm,height_cm) %>% slice(-1)
head(sample_n(fish,10),12)
library(plot3D)
scatter3D(fish$length_cm, fish$height_cm, fish$mass_g)
fish %$%
scatter3D(length_cm, height_cm, mass_g)
head(explanatory_data,4)
explanatory_data <- expand_grid(
length_cm = seq(5, 60, 5),
height_cm = seq(2, 20, 2))
head(explanatory_data,4)
prediction_data <- explanatory_data %>%
mutate(mass_g = predict(mdl_mass_vs_both, explanatory_data))
prediction_data <- explanatory_data %>%
mutate(mass_g = predict(mdl_mass_vs_both, explanatory_data))
mdl_mass_vs_both <- lm(mass_g ~ length_cm + height_cm, data = fish)
prediction_data <- explanatory_data %>%
mutate(mass_g = predict(mdl_mass_vs_both, explanatory_data))
head(prediction_data,4)
nezavisne_vars <- tibble(length_cm = 20:40)
View(nezavisne_vars)
mali_bream <- tibble(length_cm = 10)
View(mali_bream)
