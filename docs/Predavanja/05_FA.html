<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MULTIVARIJATNE STATISTIČKE METODE</title>
    <meta charset="utf-8" />
    <meta name="author" content="Luka Šikić, PhD" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# MULTIVARIJATNE STATISTIČKE METODE
## Predavanje 5: Faktorska analiza
### Luka Šikić, PhD
### Fakultet hrvatskih studija | <a href="https://lusiki.github.io/WebMultiVar/">Github MV</a>

---





&lt;style type="text/css"&gt;
@media print {
  .has-continuation {
    display: block !important;
  }
}
remark-slide-content {
  font-size: 22px;
  padding: 20px 80px 20px 80px;
}
.remark-code, .remark-inline-code {
  background: #f0f0f0;
}
.remark-code {
  font-size: 16px;
}
.mid. remark-code { /*Change made here*/
  font-size: 60% !important;
}
.tiny .remark-code { /*Change made here*/
  font-size: 40% !important;
}
&lt;/style&gt;



# Pregled predavanja

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;


1. [Jednodimenzionalna faktorska analiza (FA)](#uni)

2. [Multidimenzionalna FA](#multi)

3. [Konfirmatorna FA](#conf)


---
class: inverse, center, middle
name: uni

# FAKTORSKA ANALIZA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Općenito)

---

# Karakteristike FA

- Charles Spearman (1904) zaslužan za uvođenje FA
- FA ima mnogo sičnosti sa PCA
- Cilj FA je reducirati veliki broj (koreliranih) varijabli na mali broj indeksa (faktora)
- FA je statistički model (za razliku od PCA koja je statistička metoda)
- Ekstenzija (C)FA je modeliranje strukturnih jednadžbi SEM 
&lt;br&gt;
&lt;br&gt;

---

# Vrste FA
&lt;br&gt;
&lt;br&gt;

.pull-left[
##### EKSPLORATIVNA

- koristi se u fazi razvoja modela
- pregled faktorske strukture
- opća slika o varijablama
]

.pull-right[
##### KONFIRMATORNA

- procijeni kosntrukt
- koristi se nakon razvoja mjere

]


---
class: inverse, center, middle

# PODATCI I PODRŠKA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Pretpostavke za analizu)

---

# Paket

- koristimo `psych` paket

- za detalje o paketu pogledajte [Personality project](http://personality-project.org/r/psych/)


```r
library(psych)
```

---

# Podatci

- koristimo `gcbs` podatkovni skup (Generic Conspiracist Beliefs Survey)
- provjerite da li **i** vas prisluškuju na [Open psychometrics](https://openpsychometrics.org/tests/GCBS/) :-)



```r
gcbs &lt;- readRDS("../Podatci/GCBS_data.rds")
str(gcbs)
```

```
## 'data.frame':	2495 obs. of  15 variables:
##  $ Q1 : int  5 5 2 5 5 1 4 5 1 1 ...
##  $ Q2 : int  5 5 4 4 4 1 3 4 1 2 ...
##  $ Q3 : int  3 5 1 1 1 1 3 3 1 1 ...
##  $ Q4 : int  5 5 2 2 4 1 3 3 1 1 ...
##  $ Q5 : int  5 5 2 4 4 1 4 4 1 1 ...
##  $ Q6 : int  5 3 2 5 5 1 3 5 1 5 ...
##  $ Q7 : int  5 5 4 4 4 1 3 5 1 1 ...
##  $ Q8 : int  3 5 2 1 3 1 4 5 1 1 ...
##  $ Q9 : int  4 1 2 4 1 1 2 5 1 1 ...
##  $ Q10: int  5 4 4 5 5 1 3 5 1 4 ...
##  $ Q11: int  5 4 2 5 5 1 3 5 1 1 ...
##  $ Q12: int  5 5 4 5 5 1 2 5 1 1 ...
##  $ Q13: int  3 4 0 1 3 1 2 3 1 1 ...
##  $ Q14: int  5 4 2 4 5 1 3 4 1 1 ...
##  $ Q15: int  5 5 4 5 5 1 4 5 1 5 ...
```


---

# Konstrukti
&lt;br&gt;
&lt;br&gt;
- Zavjera vlade (GM)
&lt;br&gt;
- Prikrivanje vanzemaljaca (ET)
&lt;br&gt;
- Zle i zavjereničke globalne organizacije (MG)
&lt;br&gt;
- Osobna dobrobit (PW)
&lt;br&gt;
- Kontrola informacija (CI)

Za detalje o varijablama pogledajte [Measuring belief in conspiracy theories](https://www.frontiersin.org/articles/10.3389/fpsyg.2013.00279/full).

---

# Varijable i konstrukti

&lt;img src="../Foto/konstrukti_FA.png" width="400px" style="display: block; margin: auto;" /&gt;

---

# Jednodimenzionalni konstrukt

&lt;img src="../Foto/unidim_FA.png" width="400px" style="display: block; margin: auto;" /&gt;

---

# Jednodimenzionalni konstrukt

.tiny[
.pull-left[

```r
EFA_model &lt;- fa(gcbs)
EFA_model$loadings
```

```
## 
## Loadings:
##     MR1  
## Q1  0.703
## Q2  0.719
## Q3  0.638
## Q4  0.770
## Q5  0.672
## Q6  0.746
## Q7  0.734
## Q8  0.654
## Q9  0.695
## Q10 0.565
## Q11 0.719
## Q12 0.786
## Q13 0.679
## Q14 0.743
## Q15 0.574
## 
##                  MR1
## SS loadings    7.267
## Proportion Var 0.484
```
]
]
.pull-right[

```r
fa.diagram(EFA_model)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

]


---
class: inverse, center, middle

# RAZVOJ KONSTRUKTA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Prije analize...)

---

# Procedura razvoja konstrukta
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
- Odredi elemente konstrukta
&lt;br&gt;
&lt;br&gt;
- Prikupi podatke 
&lt;br&gt;
&lt;br&gt;
- Upoznaj se sa podatcima
&lt;br&gt;
&lt;br&gt;
- Odluka što koristiti EFA, CFA ili obje analize
&lt;br&gt;
&lt;br&gt;
- Podijeli uzorak u dva (slučajna; *random*) dijela (za obje)
&lt;br&gt;
&lt;br&gt;
- Usporedi uzorke


---

# Podatci


```r
psych::describe(gcbs)
```

```
##     vars    n mean   sd median trimmed  mad min max range  skew kurtosis   se
## Q1     1 2495 3.47 1.46      4    3.59 1.48   0   5     5 -0.55    -1.10 0.03
## Q2     2 2495 2.96 1.49      3    2.96 1.48   0   5     5 -0.01    -1.40 0.03
## Q3     3 2495 2.05 1.39      1    1.82 0.00   0   5     5  0.98    -0.44 0.03
## Q4     4 2495 2.64 1.45      2    2.55 1.48   0   5     5  0.26    -1.34 0.03
## Q5     5 2495 3.25 1.47      4    3.32 1.48   0   5     5 -0.35    -1.27 0.03
## Q6     6 2495 3.11 1.51      3    3.14 1.48   0   5     5 -0.17    -1.42 0.03
## Q7     7 2495 2.67 1.51      2    2.59 1.48   0   5     5  0.28    -1.39 0.03
## Q8     8 2495 2.45 1.57      2    2.32 1.48   0   5     5  0.51    -1.30 0.03
## Q9     9 2495 2.23 1.42      2    2.05 1.48   0   5     5  0.76    -0.82 0.03
## Q10   10 2495 3.50 1.39      4    3.63 1.48   1   5     4 -0.59    -0.94 0.03
## Q11   11 2495 3.27 1.40      4    3.34 1.48   0   5     5 -0.35    -1.11 0.03
## Q12   12 2495 2.64 1.50      2    2.56 1.48   0   5     5  0.29    -1.37 0.03
## Q13   13 2495 2.10 1.38      1    1.89 0.00   0   5     5  0.89    -0.56 0.03
## Q14   14 2495 2.96 1.49      3    2.95 1.48   0   5     5 -0.02    -1.43 0.03
## Q15   15 2495 4.23 1.10      5    4.47 0.00   0   5     5 -1.56     1.71 0.02
```


---

# Podijeli podatke
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

```r
N &lt;- nrow(gcbs)
indices &lt;- seq(1,N)
indices_EFA &lt;- sample(indices,floor((0.5 * N)))
indices_CFA &lt;- indices[!(indices %in% indices_EFA)]
gcbs_EFA &lt;- gcbs[indices_EFA, ]
gcbs_CFA &lt;- gcbs[indices_CFA, ]
```

---

# Usporedi polovice
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

```r
group_var &lt;- vector("numeric", nrow(gcbs))
group_var[indices_EFA] &lt;- 1
group_var[indices_CFA] &lt;- 2
head(group_var,450)
```

```
##   [1] 2 1 2 2 2 1 1 1 1 1 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 1 2 2 2 2 2 2 1 2 1 2 2
##  [38] 1 2 1 1 2 2 2 2 1 2 1 1 2 2 2 1 2 2 2 1 1 2 1 1 1 1 2 2 1 2 2 1 1 2 1 2 1
##  [75] 1 2 1 1 1 1 1 1 1 2 2 1 1 1 2 2 1 1 1 2 2 2 2 2 2 1 2 2 1 2 2 2 2 1 1 2 2
## [112] 1 2 1 2 2 1 1 1 2 1 2 2 1 2 2 1 2 2 2 1 1 1 2 1 1 2 2 2 1 1 2 1 2 1 1 2 2
## [149] 1 2 1 2 2 1 1 1 1 2 1 1 1 1 2 2 1 2 1 2 1 1 2 1 1 2 2 2 1 1 2 2 2 2 2 2 2
## [186] 2 1 1 1 2 2 1 2 2 2 2 2 1 1 1 1 1 2 2 2 2 1 1 2 2 1 2 1 1 1 1 2 2 2 2 2 2
## [223] 2 1 2 2 1 1 1 2 2 1 2 1 2 2 1 1 1 2 2 1 2 1 1 2 2 2 2 2 2 2 2 1 2 2 1 1 2
## [260] 1 1 1 2 1 2 2 2 1 2 1 1 2 1 1 2 1 1 2 1 1 2 1 2 1 1 1 1 1 1 1 1 2 2 1 2 1
## [297] 2 1 1 1 1 1 1 1 1 2 2 1 2 2 2 2 2 1 1 1 1 2 2 2 2 1 1 2 1 2 1 2 2 2 2 2 2
## [334] 2 2 2 2 1 1 1 1 2 2 2 1 2 1 1 1 2 1 1 1 1 2 1 2 1 1 1 2 2 1 1 2 1 1 2 1 1
## [371] 1 1 1 2 2 2 1 1 1 1 2 2 2 1 2 2 1 1 2 2 2 2 1 1 1 1 2 1 1 1 2 2 1 2 1 1 1
## [408] 2 1 1 2 1 1 2 1 2 1 1 1 2 2 2 1 1 1 2 1 1 1 2 1 2 1 2 2 2 1 1 1 2 2 1 1 1
## [445] 2 1 1 1 2 1
```

---

# Usporedi polovice

.tiny[

```r
gcbs_grouped &lt;- cbind(gcbs, group_var)
describeBy(gcbs_grouped, group = group_var)
```

```
## 
##  Descriptive statistics by group 
## group: 1
##           vars    n mean   sd median trimmed  mad min max range  skew kurtosis
## Q1           1 1247 3.49 1.46      4    3.62 1.48   0   5     5 -0.58    -1.06
## Q2           2 1247 3.00 1.50      3    3.01 1.48   0   5     5 -0.04    -1.41
## Q3           3 1247 2.06 1.39      1    1.83 0.00   0   5     5  0.97    -0.45
## Q4           4 1247 2.63 1.46      2    2.54 1.48   0   5     5  0.27    -1.34
## Q5           5 1247 3.28 1.47      4    3.36 1.48   0   5     5 -0.38    -1.23
## Q6           6 1247 3.13 1.48      3    3.17 1.48   0   5     5 -0.18    -1.38
## Q7           7 1247 2.71 1.51      3    2.64 1.48   0   5     5  0.24    -1.40
## Q8           8 1247 2.47 1.57      2    2.34 1.48   0   5     5  0.50    -1.29
## Q9           9 1247 2.26 1.42      2    2.08 1.48   0   5     5  0.75    -0.82
## Q10         10 1247 3.51 1.39      4    3.63 1.48   1   5     4 -0.57    -0.95
## Q11         11 1247 3.33 1.39      4    3.42 1.48   0   5     5 -0.42    -1.02
## Q12         12 1247 2.68 1.50      2    2.60 1.48   0   5     5  0.27    -1.39
## Q13         13 1247 2.11 1.39      1    1.90 0.00   0   5     5  0.89    -0.55
## Q14         14 1247 3.02 1.48      3    3.02 1.48   0   5     5 -0.08    -1.41
## Q15         15 1247 4.24 1.10      5    4.49 0.00   1   5     4 -1.61     1.87
## group_var   16 1247 1.00 0.00      1    1.00 0.00   1   1     0   NaN      NaN
##             se
## Q1        0.04
## Q2        0.04
## Q3        0.04
## Q4        0.04
## Q5        0.04
## Q6        0.04
## Q7        0.04
## Q8        0.04
## Q9        0.04
## Q10       0.04
## Q11       0.04
## Q12       0.04
## Q13       0.04
## Q14       0.04
## Q15       0.03
## group_var 0.00
## ------------------------------------------------------------ 
## group: 2
##           vars    n mean   sd median trimmed  mad min max range  skew kurtosis
## Q1           1 1248 3.45 1.46      4    3.57 1.48   1   5     4 -0.52    -1.15
## Q2           2 1248 2.92 1.49      3    2.91 1.48   0   5     5  0.03    -1.38
## Q3           3 1248 2.03 1.39      1    1.81 0.00   0   5     5  0.99    -0.45
## Q4           4 1248 2.64 1.44      2    2.55 1.48   0   5     5  0.25    -1.34
## Q5           5 1248 3.22 1.47      4    3.29 1.48   0   5     5 -0.31    -1.30
## Q6           6 1248 3.09 1.53      3    3.11 1.48   0   5     5 -0.15    -1.46
## Q7           7 1248 2.62 1.51      2    2.53 1.48   0   5     5  0.33    -1.38
## Q8           8 1248 2.44 1.57      2    2.30 1.48   0   5     5  0.52    -1.30
## Q9           9 1248 2.21 1.41      2    2.02 1.48   0   5     5  0.76    -0.83
## Q10         10 1248 3.50 1.39      4    3.62 1.48   1   5     4 -0.60    -0.94
## Q11         11 1248 3.20 1.41      3    3.25 1.48   0   5     5 -0.28    -1.19
## Q12         12 1248 2.61 1.50      2    2.52 1.48   0   5     5  0.31    -1.35
## Q13         13 1248 2.09 1.38      1    1.89 0.00   0   5     5  0.88    -0.58
## Q14         14 1248 2.90 1.50      3    2.87 1.48   0   5     5  0.05    -1.44
## Q15         15 1248 4.21 1.11      5    4.45 0.00   0   5     5 -1.51     1.54
## group_var   16 1248 2.00 0.00      2    2.00 0.00   2   2     0   NaN      NaN
##             se
## Q1        0.04
## Q2        0.04
## Q3        0.04
## Q4        0.04
## Q5        0.04
## Q6        0.04
## Q7        0.04
## Q8        0.04
## Q9        0.04
## Q10       0.04
## Q11       0.04
## Q12       0.04
## Q13       0.04
## Q14       0.04
## Q15       0.03
## group_var 0.00
```
]
---

# Usporedi polovice
.tiny[

```r
statsBy(gcbs_grouped, group = "group_var")
```

```
## Statistics within and between groups  
## Call: statsBy(data = gcbs_grouped, group = "group_var")
## Intraclass Correlation 1 (Percentage of variance due to groups) 
##        Q1        Q2        Q3        Q4        Q5        Q6        Q7        Q8 
##         0         0         0         0         0         0         0         0 
##        Q9       Q10       Q11       Q12       Q13       Q14       Q15 group_var 
##         0         0         0         0         0         0         0         1 
## Intraclass Correlation 2 (Reliability of group differences) 
##        Q1        Q2        Q3        Q4        Q5        Q6        Q7        Q8 
##     -1.35      0.41     -2.91    -74.16      0.02     -0.87      0.57     -3.16 
##        Q9       Q10       Q11       Q12       Q13       Q14       Q15 group_var 
##     -0.26    -25.40      0.82      0.30     -9.71      0.76     -1.32      1.00 
## eta^2 between groups  
##  Q1.bg  Q2.bg  Q3.bg  Q4.bg  Q5.bg  Q6.bg  Q7.bg  Q8.bg  Q9.bg Q10.bg Q11.bg 
##      0      0      0      0      0      0      0      0      0      0      0 
## Q12.bg Q13.bg Q14.bg Q15.bg 
##      0      0      0      0 
## 
## To see the correlations between and within groups, use the short=FALSE option in your print statement.
## Many results are not shown directly. To see specific objects select from the following list:
##  mean sd n F ICC1 ICC2 ci1 ci2 raw rbg pbg rwg nw ci.wg pwg etabg etawg nwg nG Call
```
]
---

# Korelacije varijabli


```r
lowerCor(gcbs)
```

```
##     Q1   Q2   Q3   Q4   Q5   Q6   Q7   Q8   Q9   Q10  Q11 
## Q1  1.00                                                  
## Q2  0.53 1.00                                             
## Q3  0.36 0.40 1.00                                        
## Q4  0.52 0.53 0.50 1.00                                   
## Q5  0.48 0.46 0.40 0.57 1.00                              
## Q6  0.63 0.55 0.40 0.61 0.50 1.00                         
## Q7  0.47 0.67 0.42 0.57 0.45 0.54 1.00                    
## Q8  0.39 0.38 0.78 0.49 0.41 0.41 0.41 1.00               
## Q9  0.42 0.49 0.49 0.56 0.46 0.48 0.53 0.48 1.00          
## Q10 0.44 0.38 0.32 0.40 0.43 0.41 0.39 0.36 0.37 1.00     
## Q11 0.64 0.52 0.34 0.52 0.49 0.62 0.49 0.37 0.46 0.45 1.00
## Q12 0.52 0.72 0.44 0.60 0.49 0.59 0.75 0.42 0.57 0.40 0.55
## Q13 0.38 0.40 0.71 0.51 0.43 0.42 0.45 0.76 0.54 0.37 0.40
## Q14 0.53 0.50 0.43 0.60 0.54 0.55 0.52 0.45 0.55 0.41 0.56
## Q15 0.51 0.40 0.27 0.39 0.45 0.47 0.39 0.31 0.32 0.45 0.54
##     Q12  Q13  Q14  Q15 
## Q12 1.00               
## Q13 0.49 1.00          
## Q14 0.56 0.50 1.00     
## Q15 0.41 0.30 0.46 1.00
```

---

# Signifikantnost korelacija
.tiny[

```r
corr.test(gcbs, use = "pairwise.complete.obs")$p
```

```
##                Q1            Q2            Q3            Q4            Q5
## Q1   0.000000e+00 1.038105e-175  2.525793e-74 1.746323e-174 5.801103e-143
## Q2  1.384140e-177  0.000000e+00  6.236650e-93 8.388030e-183 1.237758e-127
## Q3   3.608276e-75  3.282447e-94  0.000000e+00 1.087371e-155  1.282718e-94
## Q4  2.359896e-176 1.075388e-184 1.647531e-157  0.000000e+00 7.309882e-214
## Q5  1.054746e-144 2.578663e-129  6.108182e-96 8.032837e-216  0.000000e+00
## Q6  1.477903e-277 1.757495e-198  1.248831e-96 3.037754e-253 1.470071e-154
## Q7  8.142449e-139  0.000000e+00 5.318107e-109 5.260693e-212 2.336455e-122
## Q8   1.549786e-91  5.579984e-85  0.000000e+00 1.898345e-150 1.224898e-101
## Q9  4.344797e-106 3.376084e-148 3.104324e-151 3.108940e-210 1.462606e-133
## Q10 3.550942e-116  9.131376e-87  6.760094e-61  1.298818e-98 1.476449e-111
## Q11 9.499179e-292 1.822105e-173  2.580298e-69 9.037626e-175 2.540009e-153
## Q12 9.097129e-175  0.000000e+00 1.005698e-117 1.550592e-244 2.612164e-152
## Q13  9.052542e-87  1.297778e-96  0.000000e+00 1.798859e-167 1.168044e-111
## Q14 1.912163e-184 3.969981e-158 1.103607e-113 8.219433e-248 4.008639e-188
## Q15 9.793389e-162  3.129498e-96  1.676489e-41  1.255385e-93 3.849304e-125
##                Q6            Q7            Q8            Q9           Q10
## Q1  1.448345e-275 4.315498e-137  2.634636e-90 1.433783e-104 1.420377e-114
## Q2  1.493871e-196  0.000000e+00  6.695981e-84 1.958129e-146  1.267356e-85
## Q3   2.997195e-95 1.861338e-107  0.000000e+00 1.862595e-149  2.704037e-60
## Q4  2.916244e-251 4.734624e-210 1.120024e-148 2.766957e-208  3.376926e-97
## Q5  9.408454e-153 9.813111e-121 3.429715e-100 7.459290e-132 5.462862e-110
## Q6   0.000000e+00 2.582592e-187 1.111480e-101 4.903141e-145  2.966233e-99
## Q7  3.149502e-189  0.000000e+00 1.110564e-101 4.177923e-178  1.437786e-89
## Q8  3.704932e-103 3.582463e-103  0.000000e+00 3.981155e-142  1.778530e-78
## Q9  8.755609e-147 5.497267e-180 7.372509e-144  0.000000e+00  2.784487e-79
## Q10 1.098605e-100  9.585238e-91  2.223163e-79  3.093874e-80  0.000000e+00
## Q11 4.981130e-268 8.601767e-153  2.643708e-82 1.655959e-131 4.633595e-125
## Q12 2.403960e-231  0.000000e+00 5.764588e-109 7.071640e-216  1.561964e-98
## Q13 1.353745e-109 7.858024e-124  0.000000e+00 2.581509e-186  4.747674e-81
## Q14 7.044729e-195 6.545724e-170 2.485870e-124 2.858794e-201 3.168647e-104
## Q15 1.340087e-134  7.843219e-91  4.328489e-55  4.516727e-61 2.157366e-124
##               Q11           Q12           Q13           Q14           Q15
## Q1  9.404187e-290 6.597467e-173  1.267356e-85 1.472366e-182 6.659505e-160
## Q2  1.293694e-171  0.000000e+00  2.997195e-95 2.659887e-156  6.884895e-95
## Q3   1.548179e-68 4.123361e-116  0.000000e+00 4.304066e-112  1.676489e-41
## Q4  6.597467e-173 1.457557e-242 1.241212e-165 7.808462e-246  2.259693e-92
## Q5  1.600206e-151 1.593420e-150 4.438568e-110 3.206912e-186 1.809173e-123
## Q6  4.831696e-266 2.235683e-229 4.873482e-108 5.847125e-193 6.968453e-133
## Q7  5.333096e-151  0.000000e+00 3.378951e-122 4.582007e-168  1.254915e-89
## Q8   2.908079e-81 1.959960e-107  0.000000e+00 1.093783e-122  1.298547e-54
## Q9  8.114201e-130 6.505909e-214 2.039392e-184 2.458563e-199  2.258363e-60
## Q10 2.131454e-123  3.904910e-97  4.747674e-80 1.013967e-102 9.708145e-123
## Q11  0.000000e+00 1.571210e-193  1.584049e-94 1.610933e-205 1.319712e-186
## Q12 1.870488e-195  0.000000e+00 9.395071e-146 1.350081e-206 3.398356e-100
## Q13  7.920246e-96 1.648258e-147  0.000000e+00 6.585550e-154  2.751475e-52
## Q14 1.851647e-207 1.534183e-208 1.013162e-155  0.000000e+00 2.883420e-130
## Q15 1.629274e-188 1.171847e-101  1.375737e-52 5.766839e-132  0.000000e+00
```
]

---

# Intervali pouzdanosti
.tiny[

```r
corr.test(gcbs, use = "pairwise.complete.obs")$ci
```

```
##             lower         r     upper             p
## Q1-Q2   0.4970162 0.5259992 0.5538098 1.384140e-177
## Q1-Q3   0.3206223 0.3553928 0.3892067  3.608276e-75
## Q1-Q4   0.4953852 0.5244323 0.5523079 2.359896e-176
## Q1-Q5   0.4503342 0.4810747 0.5106759 1.054746e-144
## Q1-Q6   0.6071117 0.6313131 0.6543444 1.477903e-277
## Q1-Q7   0.4412058 0.4722710 0.5022057 8.142449e-139
## Q1-Q8   0.3564216 0.3902059 0.4229712  1.549786e-91
## Q1-Q9   0.3850453 0.4179718 0.4498355 4.344797e-106
## Q1-Q10  0.4034438 0.4357865 0.4670415 3.550942e-116
## Q1-Q11  0.6199265 0.6435136 0.6659388 9.499179e-292
## Q1-Q12  0.4932727 0.5224025 0.5503620 9.097129e-175
## Q1-Q13  0.3464313 0.3805006 0.4135673  9.052542e-87
## Q1-Q14  0.5059498 0.5345780 0.5620298 1.912163e-184
## Q1-Q15  0.4753633 0.5051815 0.5338405 9.793389e-162
## Q2-Q3   0.3618855 0.3955108 0.4281083  3.282447e-94
## Q2-Q4   0.5062706 0.5348860 0.5623248 1.075388e-184
## Q2-Q5   0.4259018 0.4574975 0.4879788 2.578663e-129
## Q2-Q6   0.5234810 0.5513960 0.5781285 1.757495e-198
## Q2-Q7   0.6501266 0.6722188 0.6931753  0.000000e+00
## Q2-Q8   0.3425926 0.3767693 0.4099501  5.579984e-85
## Q2-Q9   0.4556319 0.4861810 0.5155863 3.376084e-148
## Q2-Q10  0.3464233 0.3804928 0.4135598  9.131376e-87
## Q2-Q11  0.4915283 0.5207263 0.5487548 1.822105e-173
## Q2-Q12  0.6962013 0.7158851 0.7344931  0.000000e+00
## Q2-Q13  0.3667134 0.4001964 0.4326439  1.297778e-96
## Q2-Q14  0.4702225 0.5002339 0.5290898 3.969981e-158
## Q2-Q15  0.3659505 0.3994560 0.4319274  3.129498e-96
## Q3-Q4   0.4693335 0.4993781 0.5282679 1.647531e-157
## Q3-Q5   0.3653695 0.3988923 0.4313817  6.108182e-96
## Q3-Q6   0.3667467 0.4002287 0.4326752  1.248831e-96
## Q3-Q7   0.3904688 0.4232258 0.4549125 5.318107e-109
## Q3-Q8   0.7683496 0.7839542 0.7986273  0.000000e+00
## Q3-Q9   0.4601647 0.4905484 0.5197845 3.104324e-151
## Q3-Q10  0.2853436 0.3209913 0.3557521  6.760094e-61
## Q3-Q11  0.3066780 0.3418064 0.3760050  2.580298e-69
## Q3-Q12  0.4061739 0.4384278 0.4695906 1.005698e-117
## Q3-Q13  0.6919756 0.7118867 0.7307155  0.000000e+00
## Q3-Q14  0.3989973 0.4314834 0.4628876 1.103607e-113
## Q3-Q15  0.2285790 0.2654400 0.3015410  1.676489e-41
## Q4-Q5   0.5438704 0.5709273 0.5967985 8.032837e-216
## Q4-Q6   0.5837641 0.6090539 0.6331630 3.037754e-253
## Q4-Q7   0.5394959 0.5667395 0.5927977 5.260693e-212
## Q4-Q8   0.4589969 0.4894234 0.5187032 1.898345e-150
## Q4-Q9   0.5374441 0.5647747 0.5909202 3.108940e-210
## Q4-Q10  0.3706739 0.4040387 0.4363621  1.298818e-98
## Q4-Q11  0.4932765 0.5224062 0.5503655 9.037626e-175
## Q4-Q12  0.5749365 0.6006273 0.6251350 1.550592e-244
## Q4-Q13  0.4833700 0.5128834 0.5412322 1.798859e-167
## Q4-Q14  0.5782876 0.6038268 0.6281838 8.219433e-248
## Q4-Q15  0.3607035 0.3943633 0.4269973  1.255385e-93
## Q5-Q6   0.4650551 0.4952588 0.5243108 1.470071e-154
## Q5-Q7   0.4142088 0.4461981 0.4770864 2.336455e-122
## Q5-Q8   0.3765708 0.4097576 0.4418941 1.224898e-101
## Q5-Q9   0.4328328 0.4641904 0.4944261 1.462606e-133
## Q5-Q10  0.3951535 0.4277623 0.4592945 1.476449e-111
## Q5-Q11  0.4632435 0.4935141 0.5226345 2.540009e-153
## Q5-Q12  0.4617541 0.4920795 0.5212560 2.612164e-152
## Q5-Q13  0.3953385 0.4279414 0.4594675 1.168044e-111
## Q5-Q14  0.5106389 0.5390785 0.5663399 4.008639e-188
## Q5-Q15  0.4189383 0.4507697 0.4814945 3.849304e-125
## Q6-Q7   0.5120337 0.5404170 0.5676214 3.149502e-189
## Q6-Q8   0.3794902 0.4125879 0.4446310 3.704932e-103
## Q6-Q9   0.4534992 0.4841255 0.5136099 8.755609e-147
## Q6-Q10  0.3747259 0.4079687 0.4401639 1.098605e-100
## Q6-Q11  0.5981808 0.6228032 0.6462508 4.981130e-268
## Q6-Q12  0.5610551 0.5873651 0.6124896 2.403960e-231
## Q6-Q13  0.3915639 0.4242864 0.4559371 1.353745e-109
## Q6-Q14  0.5190730 0.5471694 0.5740847 7.044729e-195
## Q6-Q15  0.4345044 0.4658040 0.4959800 1.340087e-134
## Q7-Q8   0.3795181 0.4126150 0.4446571 3.582463e-103
## Q7-Q9   0.5001718 0.5290301 0.5567146 5.497267e-180
## Q7-Q10  0.3547857 0.3886172 0.4214323  9.585238e-91
## Q7-Q11  0.4624648 0.4927641 0.5219138 8.601767e-153
## Q7-Q12  0.7365820 0.7540288 0.7704729  0.000000e+00
## Q7-Q13  0.4167211 0.4486267 0.4794284 7.858024e-124
## Q7-Q14  0.4867147 0.5160994 0.5443174 6.545724e-170
## Q7-Q15  0.3549662 0.3887925 0.4216021  7.843219e-91
## Q8-Q9   0.4490408 0.4798277 0.5094765 7.372509e-144
## Q8-Q10  0.3302521 0.3647668 0.3983073  2.223163e-79
## Q8-Q11  0.3367608 0.3710987 0.4044508  2.643708e-82
## Q8-Q12  0.3904041 0.4231631 0.4548520 5.764588e-109
## Q8-Q13  0.7398147 0.7570774 0.7733440  0.000000e+00
## Q8-Q14  0.4175690 0.4494462 0.4802185 2.485870e-124
## Q8-Q15  0.2696028 0.3056115 0.3407668  4.328489e-55
## Q9-Q10  0.3321729 0.3666358 0.4001210  3.093874e-80
## Q9-Q11  0.4294991 0.4609717 0.4913259 1.655959e-131
## Q9-Q12  0.5439334 0.5709876 0.5968561 7.071640e-216
## Q9-Q13  0.5083417 0.5368740 0.5642288 2.581509e-186
## Q9-Q14  0.5268510 0.5546263 0.5812182 2.858794e-201
## Q9-Q15  0.2858045 0.3214413 0.3561903  4.516727e-61
## Q10-Q11 0.4188025 0.4506384 0.4813679 4.633595e-125
## Q10-Q12 0.3705162 0.4038857 0.4362140  1.561964e-98
## Q10-Q13 0.3339871 0.3684007 0.4018335  4.747674e-81
## Q10-Q14 0.3815258 0.4145611 0.4465387 3.168647e-104
## Q10-Q15 0.4176732 0.4495470 0.4803157 2.157366e-124
## Q11-Q12 0.5197817 0.5478491 0.5747350 1.870488e-195
## Q11-Q13 0.3651436 0.3986730 0.4311694  7.920246e-96
## Q11-Q14 0.5342028 0.5616704 0.5879532 1.851647e-207
## Q11-Q15 0.5111332 0.5395529 0.5667941 1.629274e-188
## Q12-Q13 0.4545949 0.4851817 0.5146255 1.648258e-147
## Q12-Q14 0.5354702 0.5628844 0.5891136 1.534183e-208
## Q12-Q15 0.3766079 0.4097936 0.4419289 1.171847e-101
## Q13-Q14 0.4667464 0.4968874 0.5258754 1.013162e-155
## Q13-Q15 0.2625236 0.2986885 0.3340155  1.375737e-52
## Q14-Q15 0.4302457 0.4616926 0.4920203 5.766839e-132
```
]

---

# Alfa koeficijent

.tiny[

```r
alpha(gcbs)
```

```
## 
## Reliability analysis   
## Call: alpha(x = gcbs)
## 
##   raw_alpha std.alpha G6(smc) average_r S/N   ase mean sd median_r
##       0.93      0.93    0.94      0.48  14 0.002  2.9  1     0.47
## 
##  lower alpha upper     95% confidence boundaries
## 0.93 0.93 0.94 
## 
##  Reliability if an item is dropped:
##     raw_alpha std.alpha G6(smc) average_r S/N alpha se  var.r med.r
## Q1       0.93      0.93    0.94      0.48  13   0.0021 0.0105  0.46
## Q2       0.93      0.93    0.94      0.48  13   0.0021 0.0099  0.47
## Q3       0.93      0.93    0.94      0.49  13   0.0020 0.0084  0.48
## Q4       0.93      0.93    0.94      0.47  13   0.0022 0.0105  0.46
## Q5       0.93      0.93    0.94      0.48  13   0.0021 0.0112  0.48
## Q6       0.93      0.93    0.94      0.48  13   0.0021 0.0104  0.46
## Q7       0.93      0.93    0.94      0.48  13   0.0021 0.0098  0.47
## Q8       0.93      0.93    0.94      0.48  13   0.0020 0.0086  0.49
## Q9       0.93      0.93    0.94      0.48  13   0.0021 0.0108  0.46
## Q10      0.93      0.93    0.94      0.49  14   0.0020 0.0102  0.49
## Q11      0.93      0.93    0.94      0.48  13   0.0021 0.0104  0.46
## Q12      0.93      0.93    0.94      0.47  13   0.0022 0.0093  0.46
## Q13      0.93      0.93    0.94      0.48  13   0.0021 0.0092  0.48
## Q14      0.93      0.93    0.94      0.48  13   0.0021 0.0109  0.46
## Q15      0.93      0.93    0.94      0.49  14   0.0020 0.0095  0.49
## 
##  Item statistics 
##        n raw.r std.r r.cor r.drop mean  sd
## Q1  2495  0.73  0.73  0.70   0.68  3.5 1.5
## Q2  2495  0.74  0.74  0.72   0.69  3.0 1.5
## Q3  2495  0.68  0.67  0.66   0.62  2.0 1.4
## Q4  2495  0.78  0.78  0.76   0.74  2.6 1.5
## Q5  2495  0.70  0.70  0.67   0.65  3.3 1.5
## Q6  2495  0.76  0.76  0.74   0.72  3.1 1.5
## Q7  2495  0.75  0.75  0.73   0.70  2.7 1.5
## Q8  2495  0.69  0.69  0.68   0.63  2.5 1.6
## Q9  2495  0.72  0.72  0.69   0.67  2.2 1.4
## Q10 2495  0.61  0.61  0.57   0.55  3.5 1.4
## Q11 2495  0.74  0.74  0.72   0.69  3.3 1.4
## Q12 2495  0.79  0.79  0.79   0.75  2.6 1.5
## Q13 2495  0.71  0.71  0.70   0.66  2.1 1.4
## Q14 2495  0.76  0.76  0.74   0.71  3.0 1.5
## Q15 2495  0.60  0.62  0.58   0.56  4.2 1.1
## 
## Non missing response frequency for each item
##        0    1    2    3    4    5 miss
## Q1  0.00 0.16 0.12 0.12 0.27 0.32    0
## Q2  0.01 0.23 0.19 0.16 0.20 0.22    0
## Q3  0.00 0.55 0.13 0.12 0.10 0.10    0
## Q4  0.00 0.32 0.18 0.15 0.20 0.14    0
## Q5  0.00 0.19 0.14 0.13 0.28 0.26    0
## Q6  0.00 0.23 0.15 0.15 0.23 0.24    0
## Q7  0.00 0.33 0.19 0.13 0.18 0.17    0
## Q8  0.00 0.44 0.12 0.14 0.12 0.18    0
## Q9  0.00 0.45 0.19 0.12 0.12 0.11    0
## Q10 0.00 0.14 0.12 0.14 0.30 0.30    0
## Q11 0.00 0.16 0.14 0.19 0.27 0.24    0
## Q12 0.00 0.34 0.18 0.15 0.17 0.17    0
## Q13 0.01 0.51 0.15 0.15 0.10 0.09    0
## Q14 0.00 0.25 0.17 0.15 0.22 0.20    0
## Q15 0.00 0.05 0.05 0.08 0.27 0.55    0
```
]

---

# Pouzdanost podjele


```r
splitHalf(gcbs)
```

```
## Split half reliabilities  
## Call: splitHalf(r = gcbs)
## 
## Maximum split half reliability (lambda 4) =  0.95
## Guttman lambda 6                          =  0.94
## Average split half reliability            =  0.93
## Guttman lambda 3 (alpha)                  =  0.93
## Guttman lambda 2                          =  0.93
## Minimum split half reliability  (beta)    =  0.86
## Average interitem r =  0.48  with median =  0.47
```

---
class: inverse, center, middle
name: uni

# MULTIDIMENZIONALNA FA

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(U praksi uvijek ima više od jedne dimenzije)

---

# Podatci

- koristimo podatke Synthetic Aperture Personality Assessment (SAPA)
- 2.800 osoba
- 25 pitanja
.tiny[

```r
data(bfi)
str(bfi)
```

```
## 'data.frame':	2800 obs. of  28 variables:
##  $ A1       : int  2 2 5 4 2 6 2 4 4 2 ...
##  $ A2       : int  4 4 4 4 3 6 5 3 3 5 ...
##  $ A3       : int  3 5 5 6 3 5 5 1 6 6 ...
##  $ A4       : int  4 2 4 5 4 6 3 5 3 6 ...
##  $ A5       : int  4 5 4 5 5 5 5 1 3 5 ...
##  $ C1       : int  2 5 4 4 4 6 5 3 6 6 ...
##  $ C2       : int  3 4 5 4 4 6 4 2 6 5 ...
##  $ C3       : int  3 4 4 3 5 6 4 4 3 6 ...
##  $ C4       : int  4 3 2 5 3 1 2 2 4 2 ...
##  $ C5       : int  4 4 5 5 2 3 3 4 5 1 ...
##  $ E1       : int  3 1 2 5 2 2 4 3 5 2 ...
##  $ E2       : int  3 1 4 3 2 1 3 6 3 2 ...
##  $ E3       : int  3 6 4 4 5 6 4 4 NA 4 ...
##  $ E4       : int  4 4 4 4 4 5 5 2 4 5 ...
##  $ E5       : int  4 3 5 4 5 6 5 1 3 5 ...
##  $ N1       : int  3 3 4 2 2 3 1 6 5 5 ...
##  $ N2       : int  4 3 5 5 3 5 2 3 5 5 ...
##  $ N3       : int  2 3 4 2 4 2 2 2 2 5 ...
##  $ N4       : int  2 5 2 4 4 2 1 6 3 2 ...
##  $ N5       : int  3 5 3 1 3 3 1 4 3 4 ...
##  $ O1       : int  3 4 4 3 3 4 5 3 6 5 ...
##  $ O2       : int  6 2 2 3 3 3 2 2 6 1 ...
##  $ O3       : int  3 4 5 4 4 5 5 4 6 5 ...
##  $ O4       : int  4 3 5 3 3 6 6 5 6 5 ...
##  $ O5       : int  3 3 2 5 3 1 1 3 1 2 ...
##  $ gender   : int  1 2 2 2 1 2 1 1 1 2 ...
##  $ education: int  NA NA NA NA NA 3 NA 2 1 NA ...
##  $ age      : int  16 18 17 17 17 21 18 19 19 17 ...
```
]

---

# Podatci


```r
head(bfi)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 61617  2  4  3  4  4  2  3  3  4  4  3  3  3  4  4  3  4  2  2  3  3  6  3  4
## 61618  2  4  5  2  5  5  4  4  3  4  1  1  6  4  3  3  3  3  5  5  4  2  4  3
## 61620  5  4  5  4  4  4  5  4  2  5  2  4  4  4  5  4  5  4  2  3  4  2  5  5
## 61621  4  4  6  5  5  4  4  3  5  5  5  3  4  4  4  2  5  2  4  1  3  3  4  3
## 61622  2  3  3  4  5  4  4  5  3  2  2  2  5  4  5  2  3  4  4  3  3  3  4  3
## 61623  6  6  5  6  5  6  6  6  1  3  2  1  6  5  6  3  5  2  2  3  4  3  5  6
##       O5 gender education age
## 61617  3      1        NA  16
## 61618  3      2        NA  18
## 61620  2      2        NA  17
## 61621  5      2        NA  17
## 61622  3      1        NA  17
## 61623  1      2         3  21
```

---

# Podatci
&lt;br&gt;
&lt;br&gt;

```r
names(bfi)
```

```
##  [1] "A1"        "A2"        "A3"        "A4"        "A5"        "C1"       
##  [7] "C2"        "C3"        "C4"        "C5"        "E1"        "E2"       
## [13] "E3"        "E4"        "E5"        "N1"        "N2"        "N3"       
## [19] "N4"        "N5"        "O1"        "O2"        "O3"        "O4"       
## [25] "O5"        "gender"    "education" "age"
```

---

# Konstrukt


&lt;img src="../Foto/bfi_FA.png" width="300px" style="display: block; margin: auto;" /&gt;

---

# Konstrukt

- konstrukt se ne može direktno mjeriti
- primjeri: samoodređenost, sposobnost razmišljanja, politička pripadnost, ekstrovertiranost 
&lt;br&gt;
&lt;br&gt;
&lt;img src="../Foto/konstrukt_FA.png" width="450px" style="display: block; margin: auto;" /&gt;

---

# Podijeli podatke
&lt;br&gt;
&lt;br&gt;


```r
N &lt;- nrow(bfi)
indices &lt;- seq(1, N)
indices_EFA &lt;- sample(indices, floor((.5*N)))
indices_CFA &lt;- indices[!(indices %in% indices_EFA)]
bfi_EFA &lt;- bfi[indices_EFA, ]
bfi_CFA &lt;- bfi[indices_CFA, ]
```

---

# Podijeli podatke


```r
head(bfi_EFA, 2)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 65236  2  5  5  4  5  4  3  3  2  2  4  4  5  5  4  3  3  2  5  2  6  6  5  2
## 63934  1 NA  6  6  6  5  5  6  1  1  1  1  6  6  6  4  4  3  1  1  6  3  6  4
##       O5 gender education age
## 65236  2      1         3  18
## 63934  1      2         3  40
```

```r
head(bfi_CFA, 2)
```

```
##       A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
## 61617  2  4  3  4  4  2  3  3  4  4  3  3  3  4  4  3  4  2  2  3  3  6  3  4
## 61618  2  4  5  2  5  5  4  4  3  4  1  1  6  4  3  3  3  3  5  5  4  2  4  3
##       O5 gender education age
## 61617  3      1        NA  16
## 61618  3      2        NA  18
```

---

# ...bez teorije


&lt;img src="../Foto/noTheory_FA.png" width="550px" style="display: block; margin: auto;" /&gt;

---

# Korelacijska matrica

.tiny[

```r
bfi_EFA_cor &lt;- cor(bfi_EFA, use = "pairwise.complete.obs")
head(bfi_EFA_cor,4) 
```

```
##            A1         A2         A3         A4         A5         C1
## A1  1.0000000 -0.3445455 -0.2818130 -0.1569495 -0.1876115 0.02912155
## A2 -0.3445455  1.0000000  0.5151999  0.3529067  0.3940969 0.07243393
## A3 -0.2818130  0.5151999  1.0000000  0.3933624  0.5152740 0.09283097
## A4 -0.1569495  0.3529067  0.3933624  1.0000000  0.3680669 0.08543133
##             C2          C3         C4          C5         E1         E2
## A1 -0.01355788 -0.02975651  0.1492102  0.03512212  0.1148489  0.1003781
## A2  0.14614015  0.17193865 -0.1353917 -0.10656152 -0.2257139 -0.2742999
## A3  0.15631625  0.14974858 -0.1333807 -0.14021076 -0.2197054 -0.3008444
## A4  0.22048664  0.13795337 -0.1262321 -0.27205174 -0.1055832 -0.2342676
##             E3          E4          E5          N1          N2           N3
## A1 -0.05144056 -0.05100744 -0.05604606  0.15542108  0.12249879  0.096534483
## A2  0.26678550  0.33183387  0.30541929 -0.03939768 -0.04578974  0.008375502
## A3  0.37867323  0.40062409  0.26993597 -0.07269371 -0.09740063 -0.017234559
## A4  0.23385181  0.31283106  0.15836403 -0.10547320 -0.15300665 -0.045559073
##             N4           N5         O1         O2          O3          O4
## A1  0.04105667  0.001703778 0.01126907 0.08063485 -0.05209643 -0.05642800
## A2 -0.07706997  0.047936800 0.14495495 0.02097183  0.18631837  0.09044407
## A3 -0.10701590 -0.017285230 0.12976743 0.03244977  0.21927353  0.03102646
## A4 -0.18384356 -0.012767916 0.11677320 0.03399033  0.11187092 -0.04277234
##             O5     gender   education         age
## A1  0.11024971 -0.1734426 -0.09660474 -0.18360452
## A2 -0.04911858  0.1799395 -0.01390967  0.13884017
## A3 -0.02847648  0.1620907 -0.03013830  0.08285966
## A4  0.04575828  0.1042104 -0.02404177  0.14587075
```
]

---

# Svojsvene vrijednosti



```r
scree(bfi_EFA_cor, factors = FALSE)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /&gt;


---

# Eksplorativna vs. konfirmatorna FA


&lt;img src="../Foto/konf_FA.png" width="350px" style="display: block; margin: auto;" /&gt;


&lt;img src="../Foto/eksp_FA.png" width="350px" style="display: block; margin: auto;" /&gt;


---

# Provedi FA

.tiny[

```r
EFA_model &lt;- fa(bfi_EFA, nfactors = 6)
EFA_model
```

```
## Factor Analysis using method =  minres
## Call: fa(r = bfi_EFA, nfactors = 6)
## Standardized loadings (pattern matrix) based upon correlation matrix
##             MR2   MR5   MR3   MR1   MR4   MR6    h2   u2 com
## A1         0.09 -0.56  0.05 -0.06  0.05  0.40 0.405 0.60 2.0
## A2         0.05  0.65  0.06 -0.08  0.05 -0.06 0.485 0.52 1.1
## A3        -0.03  0.64  0.04 -0.10  0.07  0.10 0.531 0.47 1.1
## A4        -0.09  0.43  0.17 -0.05 -0.05  0.13 0.301 0.70 1.7
## A5        -0.17  0.51  0.04 -0.16  0.08  0.19 0.481 0.52 1.8
## C1         0.02 -0.05  0.52  0.07  0.21  0.08 0.339 0.66 1.4
## C2         0.07  0.06  0.70  0.16  0.09  0.14 0.519 0.48 1.3
## C3         0.03  0.07  0.55  0.02 -0.03  0.04 0.310 0.69 1.1
## C4         0.08 -0.01 -0.64  0.10  0.05  0.29 0.553 0.45 1.5
## C5         0.16  0.02 -0.56  0.18  0.11  0.02 0.447 0.55 1.5
## E1        -0.13 -0.11  0.08  0.60 -0.07  0.07 0.392 0.61 1.3
## E2         0.04 -0.10  0.00  0.70 -0.06  0.00 0.578 0.42 1.1
## E3         0.02  0.19  0.02 -0.31  0.37  0.20 0.449 0.55 3.1
## E4        -0.05  0.25  0.06 -0.49  0.01  0.32 0.573 0.43 2.4
## E5         0.16  0.09  0.19 -0.39  0.26 -0.02 0.372 0.63 2.9
## N1         0.82 -0.08  0.00 -0.09 -0.04  0.01 0.646 0.35 1.0
## N2         0.83 -0.08  0.01 -0.06  0.01 -0.05 0.670 0.33 1.0
## N3         0.66  0.11 -0.06  0.13  0.02  0.07 0.535 0.46 1.2
## N4         0.40  0.10 -0.13  0.44  0.07  0.01 0.486 0.51 2.4
## N5         0.47  0.22  0.03  0.25 -0.12  0.11 0.382 0.62 2.4
## O1        -0.06 -0.03  0.05 -0.03  0.57  0.06 0.354 0.65 1.1
## O2         0.11  0.12 -0.08  0.00 -0.33  0.32 0.251 0.75 2.6
## O3        -0.02  0.05  0.01 -0.07  0.66  0.02 0.484 0.52 1.0
## O4         0.06  0.12 -0.03  0.36  0.41 -0.02 0.265 0.73 2.2
## O5         0.03  0.05 -0.04 -0.01 -0.49  0.34 0.356 0.64 1.8
## gender     0.24  0.30  0.10 -0.07 -0.14 -0.12 0.154 0.85 3.1
## education -0.03  0.04 -0.03  0.05  0.13 -0.22 0.066 0.93 1.9
## age       -0.04  0.21  0.06 -0.01  0.02 -0.28 0.126 0.87 2.0
## 
##                        MR2  MR5  MR3  MR1  MR4  MR6
## SS loadings           2.49 2.17 2.07 2.15 1.72 0.90
## Proportion Var        0.09 0.08 0.07 0.08 0.06 0.03
## Cumulative Var        0.09 0.17 0.24 0.32 0.38 0.41
## Proportion Explained  0.22 0.19 0.18 0.19 0.15 0.08
## Cumulative Proportion 0.22 0.41 0.58 0.77 0.92 1.00
## 
##  With factor correlations of 
##       MR2   MR5   MR3   MR1   MR4   MR6
## MR2  1.00 -0.04 -0.22  0.25  0.00  0.12
## MR5 -0.04  1.00  0.18 -0.29  0.20  0.13
## MR3 -0.22  0.18  1.00 -0.23  0.20  0.01
## MR1  0.25 -0.29 -0.23  1.00 -0.18 -0.10
## MR4  0.00  0.20  0.20 -0.18  1.00  0.03
## MR6  0.12  0.13  0.01 -0.10  0.03  1.00
## 
## Mean item complexity =  1.7
## Test of the hypothesis that 6 factors are sufficient.
## 
## The degrees of freedom for the null model are  378  and the objective function was  7.79 with Chi Square of  10817.51
## The degrees of freedom for the model are 225  and the objective function was  0.58 
## 
## The root mean square of the residuals (RMSR) is  0.02 
## The df corrected root mean square of the residuals is  0.03 
## 
## The harmonic number of observations is  1375 with the empirical chi square  609.89  with prob &lt;  3e-37 
## The total number of observations was  1400  with Likelihood Chi Square =  800.98  with prob &lt;  1.3e-65 
## 
## Tucker Lewis Index of factoring reliability =  0.907
## RMSEA index =  0.043  and the 90 % confidence intervals are  0.04 0.046
## BIC =  -828.97
## Fit based upon off diagonal values = 0.98
## Measures of factor score adequacy             
##                                                    MR2  MR5  MR3  MR1  MR4  MR6
## Correlation of (regression) scores with factors   0.93 0.89 0.89 0.89 0.86 0.78
## Multiple R square of scores with factors          0.86 0.79 0.79 0.79 0.73 0.60
## Minimum correlation of possible factor scores     0.71 0.58 0.57 0.59 0.47 0.20
```
]

---

# Faktorska opterećenja

.tiny[

```r
EFA_model$loadings
```

```
## 
## Loadings:
##           MR2    MR5    MR3    MR1    MR4    MR6   
## A1               -0.557                       0.403
## A2                0.651                            
## A3                0.643                            
## A4                0.430  0.169                0.130
## A5        -0.167  0.508        -0.159         0.191
## C1                       0.525         0.208       
## C2                       0.702  0.163         0.135
## C3                       0.555                     
## C4                      -0.639                0.289
## C5         0.156        -0.562  0.179  0.108       
## E1        -0.134 -0.113         0.603              
## E2               -0.102         0.698              
## E3                0.193        -0.313  0.370  0.201
## E4                0.253        -0.490         0.323
## E5         0.163         0.194 -0.390  0.263       
## N1         0.816                                   
## N2         0.833                                   
## N3         0.662  0.108         0.132              
## N4         0.403  0.103 -0.132  0.443              
## N5         0.467  0.222         0.250 -0.118  0.113
## O1                                     0.574       
## O2         0.108  0.120               -0.333  0.315
## O3                                     0.659       
## O4                0.116         0.357  0.408       
## O5                                    -0.488  0.341
## gender     0.243  0.301               -0.137 -0.118
## education                              0.128 -0.218
## age               0.206                      -0.283
## 
##                  MR2   MR5   MR3   MR1   MR4   MR6
## SS loadings    2.395 1.987 1.934 1.893 1.637 0.872
## Proportion Var 0.086 0.071 0.069 0.068 0.058 0.031
## Cumulative Var 0.086 0.156 0.226 0.293 0.352 0.383
```
]


---

# Faktorski koeficijenti
&lt;br&gt;
&lt;br&gt;


```r
head(EFA_model$scores)
```

```
##              MR2          MR5        MR3         MR1         MR4         MR6
## 65236 -0.3708770 -0.008069453 -0.3757078 -0.05502445 -0.01263743  0.39510648
## 63934         NA           NA         NA          NA          NA          NA
## 64857  1.3319912 -0.287495164 -0.8901881  1.84970051  0.36408568 -1.41659577
## 61679 -0.4270546  0.857095024  0.4427673 -0.77436356  0.41416484 -0.11209142
## 65583 -1.5909127  0.346370603  1.3013428 -0.79294604  0.71491818 -0.04593671
## 66318  1.0006977  0.850864429  0.3503881  1.22646369 -0.85301579  0.44706070
```

---

# Procjena kvalitete modela (fit)
&lt;br&gt;
&lt;br&gt;
##### Apsolutne mjere

- Chi-square test: nesignifikanstnost
- Tucker-Lewis Index (TLI) : &gt; 0.90
- Root Mean Square Error of Approximation (RMSEA): &lt; 0.05

##### Relativne mjere

- Bayesian Information Criterion (BIC)

---

# Procjena kvalitete modela (relativna)


```r
EFA_model &lt;- fa(bfi_EFA, nfactors = 6)
EFA_model
```


```r
bfi_theory &lt;- fa(bfi_EFA, nfactors = 5)
bfi_eigen &lt;- fa(bfi_EFA, nfactors = 6)

bfi_theory$BIC
```

```
## [1] -475.0406
```

```r
bfi_eigen$BIC
```

```
## [1] -828.9676
```

```r
bfi_theory$BIC
```

```
## [1] -475.0406
```

```r
bfi_eigen$BIC
```

```
## [1] -828.9676
```


---
class: inverse, center, middle
name: conf

# KONFIRMATORNA FA (CFA)

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Kada postoji teorija!)

---

# Razlozi za korištenje
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
- Eksplicitno specificiran odnos među varijablama
&lt;br&gt;
&lt;br&gt;
- Testiranje teorije koja je unaprijed poznata
&lt;br&gt;
&lt;br&gt;
- Pristup koji se koristi kod razvoja nove mjere


---


# Skica I (*jedan konstrukt*)
&lt;br&gt;
&lt;br&gt;


&lt;img src="assets/8130369.png" width="614" style="display: block; margin: auto;" /&gt;

---

# Skica II (*više konstrukta*)
&lt;br&gt;
&lt;br&gt;
&lt;img src="assets/4397182.png" width="507" style="display: block; margin: auto;" /&gt;


---

# Podatci



```r
hz &lt;- lavaan::HolzingerSwineford1939
hz %&gt;% dplyr::glimpse()
```

```
## Rows: 301
## Columns: 15
## $ id     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, ~
## $ sex    &lt;int&gt; 1, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, ~
## $ ageyr  &lt;int&gt; 13, 13, 13, 13, 12, 14, 12, 12, 13, 12, 12, 12, 12, 12, 12, 12,~
## $ agemo  &lt;int&gt; 1, 7, 1, 2, 2, 1, 1, 2, 0, 5, 2, 11, 7, 8, 6, 1, 11, 5, 8, 3, 1~
## $ school &lt;fct&gt; Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, ~
## $ grade  &lt;int&gt; 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, ~
## $ x1     &lt;dbl&gt; 3.333333, 5.333333, 4.500000, 5.333333, 4.833333, 5.333333, 2.8~
## $ x2     &lt;dbl&gt; 7.75, 5.25, 5.25, 7.75, 4.75, 5.00, 6.00, 6.25, 5.75, 5.25, 5.7~
## $ x3     &lt;dbl&gt; 0.375, 2.125, 1.875, 3.000, 0.875, 2.250, 1.000, 1.875, 1.500, ~
## $ x4     &lt;dbl&gt; 2.333333, 1.666667, 1.000000, 2.666667, 2.666667, 1.000000, 3.3~
## $ x5     &lt;dbl&gt; 5.75, 3.00, 1.75, 4.50, 4.00, 3.00, 6.00, 4.25, 5.75, 5.00, 3.5~
## $ x6     &lt;dbl&gt; 1.2857143, 1.2857143, 0.4285714, 2.4285714, 2.5714286, 0.857142~
## $ x7     &lt;dbl&gt; 3.391304, 3.782609, 3.260870, 3.000000, 3.695652, 4.347826, 4.6~
## $ x8     &lt;dbl&gt; 5.75, 6.25, 3.90, 5.30, 6.30, 6.65, 6.20, 5.15, 4.65, 4.55, 5.7~
## $ x9     &lt;dbl&gt; 6.361111, 7.916667, 4.416667, 4.861111, 5.916667, 7.500000, 4.8~
```

---

# Definiraj model

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;


```r
hz.model &lt;- '
visual =~ x1 + x2 + x3
writing =~ x4 + x5 + x6
maths =~ x7 + x8 + x9
'
```


.footnote[ [*]Za detalje o lavaan projektu pogledajte [stranicu](https://lavaan.ugent.be/tutorial/syntax1.html)].
---

# Provedi model



```r
hz.fit &lt;- lavaan::cfa(hz.model, data=hz)
summary(hz.fit, standardized=TRUE)
```

```
## Length  Class   Mode 
##      1 lavaan     S4
```


---

# Prikaži grafički



```r
semPlot::semPaths(hz.fit)
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-41-1.png" style="display: block; margin: auto;" /&gt;


---

# Prikaži grafički 



```r
semPlot::semPaths(hz.fit, "std")
```

&lt;img src="05_FA_files/figure-html/unnamed-chunk-42-1.png" style="display: block; margin: auto;" /&gt;


---

# Kvaliteta procjene (Fit)

&lt;br&gt;
&lt;br&gt;

```r
lavaan::fitmeasures(hz.fit, c('cfi', 'rmsea', 'rmsea.ci.upper', 'bic'))
```

```
##            cfi          rmsea rmsea.ci.upper            bic 
##          0.931          0.092          0.114       7595.339
```



---

class: inverse, center, middle

# Hvala na pažnji

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

(Nastavak: Diskriminantna analiza)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
